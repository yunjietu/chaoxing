import e from"./help-doc-form-drawer-BZ3nko0t.js";import{c as a,v as t,s as l,P as o}from"./index-SeYMZHv7.js";import{_ as s}from"./index-C3kHkCVg.js";import{d as i}from"./default-time-ranges-C0dlfVG_.js";import{T as r}from"./table-id-const-CfofKxZg.js";import{M as n,b as d}from"./ant-design-vue-qdrtx42b.js";import{a as p,r as u,e as m,w as c,b2 as h,z as g,b as f,o as j,y,c as v,ag as b,bz as w,u as _,J as I,ai as k,ah as C,be as x,F as D}from"./@vue-wTDZSr7R.js";import"./lodash-DG05lPuJ.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./index-CtS3x09i.js";import"./@wangeditor-next-BWE1cd2r.js";import"./help-doc-catalog-tree-select-yC1AgDT7.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./menu-api-DyF2x50w.js";import"./menu-data-handler-J-32ogBg.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const z={class:"smart-table-operate-block"},S={class:"smart-table-setting-block"},O={key:1,class:"smart-table-operate"},q={class:"smart-query-table-page"},P={__name:"help-doc-list",props:{helpDocCatalogId:Number},setup(P){const N=P,T={helpDocCatalogId:N.helpDocCatalogId,keywords:"",createTimeBegin:null,createTimeEnd:null,pageNum:1,pageSize:a},E=p({...T}),U=u([{title:"标题",dataIndex:"title",ellipsis:!0},{title:"目录",dataIndex:"helpDocCatalogName",width:120,ellipsis:!0},{title:"作者",dataIndex:"author",width:110,ellipsis:!0},{title:"排序",dataIndex:"sort",width:90},{title:"页面浏览量",dataIndex:"pageViewCount",width:90},{title:"用户浏览量",dataIndex:"userViewCount",width:90},{title:"创建时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"action",fixed:"right",width:90}]),V=u([]),R=u(0),B=u(!1);async function F(){try{B.value=!0;const e=await t.query(E);V.value=e.data.list,R.value=e.data.total}catch(e){l.captureError(e)}finally{B.value=!1}}function J(){E.pageNum=1,F()}function L(){Object.assign(E,T),M.value=[],Q.value=[],F()}m((()=>{F()}));const M=u([]),Q=u([]);function $(e,a){E.createTimeBegin=a[0],E.createTimeEnd=a[1]}const A=u();function G(e){A.value.showModal(e)}function H(e){n.confirm({title:"提示",content:"确认删除此数据吗?",onOk(){!async function(e){try{B.value=!0,await t.delete(e),d.success("删除成功"),F()}catch(a){l.captureError(a)}finally{B.value=!1}}(e)}})}return c((()=>N.helpDocCatalogId),(()=>{E.helpDocCatalogId=N.helpDocCatalogId,J()}),{immediate:!0}),(a,t)=>{const l=h("a-input"),n=h("a-form-item"),d=h("a-range-picker"),p=h("SearchOutlined"),u=h("a-button"),m=h("ReloadOutlined"),c=h("a-button-group"),P=h("a-row"),N=h("a-form"),T=h("PlusOutlined"),M=h("router-link"),K=h("a-table"),W=h("a-pagination"),X=h("a-card"),Y=g("privilege");return j(),f(D,null,[y((j(),b(N,{class:"smart-query-form"},{default:w((()=>[v(P,{class:"smart-query-form-row"},{default:w((()=>[v(n,{label:"关键字",class:"smart-query-form-item"},{default:w((()=>[v(l,{style:{width:"300px"},value:E.keywords,"onUpdate:value":t[0]||(t[0]=e=>E.keywords=e),placeholder:"标题、作者"},null,8,["value"])])),_:1}),v(n,{label:"创建时间",class:"smart-query-form-item"},{default:w((()=>[v(d,{presets:_(i),value:Q.value,"onUpdate:value":t[1]||(t[1]=e=>Q.value=e),onChange:$,style:{width:"220px"}},null,8,["presets","value"])])),_:1}),v(n,{class:"smart-query-form-item smart-margin-left10"},{default:w((()=>[v(c,null,{default:w((()=>[v(u,{type:"primary",onClick:J},{icon:w((()=>[v(p)])),default:w((()=>[I(" 查询 ")])),_:1}),v(u,{onClick:L},{icon:w((()=>[v(m)])),default:w((()=>[I(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[Y,"support:helpDoc:query"]]),v(X,{size:"small",bordered:!1},{default:w((()=>[v(P,{class:"smart-table-btn-block"},{default:w((()=>[k("div",z,[y((j(),b(u,{type:"primary",onClick:t[2]||(t[2]=e=>G())},{icon:w((()=>[v(T)])),default:w((()=>[I(" 新建 ")])),_:1})),[[Y,"support:helpDoc:add"]])]),k("div",S,[v(s,{modelValue:U.value,"onUpdate:modelValue":t[3]||(t[3]=e=>U.value=e),tableId:_(r).SUPPORT.HELP_DOC,refresh:F},null,8,["modelValue","tableId"])])])),_:1}),v(K,{rowKey:"helpDocId",columns:U.value,scroll:{x:1e3},dataSource:V.value,pagination:!1,loading:B.value,size:"small",bordered:""},{bodyCell:w((({column:e,record:a})=>["title"===e.dataIndex?(j(),b(M,{key:0,tag:"a",target:"_blank",to:{path:"/help-doc/detail",query:{helpDocId:a.helpDocId}}},{default:w((()=>[I(x(a.title),1)])),_:2},1032,["to"])):"action"===e.dataIndex?(j(),f("div",O,[y((j(),b(u,{type:"link",onClick:e=>G(a.helpDocId)},{default:w((()=>[I("编辑")])),_:2},1032,["onClick"])),[[Y,"support:helpDoc:update"]]),y((j(),b(u,{type:"link",danger:"",onClick:e=>H(a.helpDocId)},{default:w((()=>[I("删除")])),_:2},1032,["onClick"])),[[Y,"support:helpDoc:delete"]])])):C("",!0)])),_:1},8,["columns","dataSource","loading"]),k("div",q,[v(W,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:_(o),defaultPageSize:E.pageSize,current:E.pageNum,"onUpdate:current":t[4]||(t[4]=e=>E.pageNum=e),pageSize:E.pageSize,"onUpdate:pageSize":t[5]||(t[5]=e=>E.pageSize=e),total:R.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1}),v(e,{ref_key:"helpDocFormDrawerRef",ref:A,onReloadList:F},null,512)],64)}}};export{P as default};
