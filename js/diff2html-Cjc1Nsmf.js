import{h as e}from"./hogan.js-C2UNKCU2.js";var n;!function(e){e.INSERT="insert",e.DELETE="delete",e.CONTEXT="context"}(n||(n={}));var t;!function(e){e.AUTO="auto",e.DARK="dark",e.LIGHT="light"}(t||(t={}));const i=RegExp("["+["-","[","]","/","{","}","(",")","*","+","?",".","\\","^","$","|"].join("\\")+"]","g");function s(e){return e?e.replace(/\\/g,"/"):e}function r(e,n){const t=e.split(".");return t.length>1?t[t.length-1]:n}function l(e,n){return n.reduce(((n,t)=>n||e.startsWith(t)),!1)}const o=["a/","b/","i/","w/","c/","o/"];function a(e,n,t){const s=void 0!==t?[...o,t]:o,r=n?new RegExp(`^${l=n,l.replace(i,"\\$&")} "?(.+?)"?$`):new RegExp('^"?(.+?)"?$');var l;const[,a=""]=r.exec(e)||[],d=s.find((e=>0===a.indexOf(e)));return(d?a.slice(d.length):a).replace(/\s+\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}(?:\.\d+)? [+-]\d{4}.*$/,"")}function d(e,t={}){const i=[];let s=null,o=null,d=null,c=null,h=null,f=null,b=null;const u="--- ",p="+++ ",g="@@",m=/^old mode (\d{6})/,v=/^new mode (\d{6})/,w=/^deleted file mode (\d{6})/,y=/^new file mode (\d{6})/,N=/^copy from "?(.+)"?/,x=/^copy to "?(.+)"?/,C=/^rename from "?(.+)"?/,E=/^rename to "?(.+)"?/,T=/^similarity index (\d+)%/,L=/^dissimilarity index (\d+)%/,S=/^index ([\da-z]+)\.\.([\da-z]+)\s*(\d{6})?/,H=/^Binary files (.*) and (.*) differ/,O=/^GIT binary patch/,j=/^index ([\da-z]+),([\da-z]+)\.\.([\da-z]+)/,I=/^mode (\d{6}),(\d{6})\.\.(\d{6})/,k=/^new file mode (\d{6})/,M=/^deleted file mode (\d{6}),(\d{6})/,D=e.replace(/\\ No newline at end of file/g,"").replace(/\r\n?/g,"\n").split("\n");function z(){null!==o&&null!==s&&(s.blocks.push(o),o=null)}function W(){null!==s&&(s.oldName||null===f||(s.oldName=f),s.newName||null===b||(s.newName=b),s.newName&&(i.push(s),s=null)),f=null,b=null}function F(){z(),W(),s={blocks:[],deletedLines:0,addedLines:0}}function A(e){let n;z(),null!==s&&((n=/^@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@.*/.exec(e))?(s.isCombined=!1,d=parseInt(n[1],10),h=parseInt(n[2],10)):(n=/^@@@ -(\d+)(?:,\d+)? -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@@.*/.exec(e))?(s.isCombined=!0,d=parseInt(n[1],10),c=parseInt(n[2],10),h=parseInt(n[3],10)):(e.startsWith(g),d=0,h=0,s.isCombined=!1)),o={lines:[],oldStartLine:d,oldStartLine2:c,newStartLine:h,header:e}}return D.forEach(((e,c)=>{if(!e||e.startsWith("*"))return;let z;const W=D[c-1],B=D[c+1],R=D[c+2];if(e.startsWith("diff --git")||e.startsWith("diff --combined")){F();if((z=/^diff --git "?([a-ciow]\/.+)"? "?([a-ciow]\/.+)"?/.exec(e))&&(f=a(z[1],void 0,t.dstPrefix),b=a(z[2],void 0,t.srcPrefix)),null===s)throw new Error("Where is my file !!!");return void(s.isGitDiff=!0)}if(e.startsWith("Binary files")&&!(null==s?void 0:s.isGitDiff)){F();if((z=/^Binary files "?([a-ciow]\/.+)"? and "?([a-ciow]\/.+)"? differ/.exec(e))&&(f=a(z[1],void 0,t.dstPrefix),b=a(z[2],void 0,t.srcPrefix)),null===s)throw new Error("Where is my file !!!");return void(s.isBinary=!0)}if((!s||!s.isGitDiff&&s&&e.startsWith(u)&&B.startsWith(p)&&R.startsWith(g))&&F(),null==s?void 0:s.isTooBig)return;if(s&&("number"==typeof t.diffMaxChanges&&s.addedLines+s.deletedLines>t.diffMaxChanges||"number"==typeof t.diffMaxLineLength&&e.length>t.diffMaxLineLength)){s.isTooBig=!0,s.addedLines=0,s.deletedLines=0,s.blocks=[],o=null;return void A("function"==typeof t.diffTooBigMessage?t.diffTooBigMessage(i.length):"Diff too big to be displayed")}if(e.startsWith(u)&&B.startsWith(p)||e.startsWith(p)&&W.startsWith(u)){if(s&&!s.oldName&&e.startsWith("--- ")&&(z=function(e,n){return a(e,"---",n)}(e,t.srcPrefix)))return s.oldName=z,void(s.language=r(s.oldName,s.language));if(s&&!s.newName&&e.startsWith("+++ ")&&(z=function(e,n){return a(e,"+++",n)}(e,t.dstPrefix)))return s.newName=z,void(s.language=r(s.newName,s.language))}if(s&&(e.startsWith(g)||s.isGitDiff&&s.oldName&&s.newName&&!o))return void A(e);if(o&&(e.startsWith("+")||e.startsWith("-")||e.startsWith(" ")))return void function(e){if(null===s||null===o||null===d||null===h)return;const t={content:e},i=s.isCombined?["+ "," +","++"]:["+"],r=s.isCombined?["- "," -","--"]:["-"];l(e,i)?(s.addedLines++,t.type=n.INSERT,t.oldNumber=void 0,t.newNumber=h++):l(e,r)?(s.deletedLines++,t.type=n.DELETE,t.oldNumber=d++,t.newNumber=void 0):(t.type=n.CONTEXT,t.oldNumber=d++,t.newNumber=h++),o.lines.push(t)}(e);const P=!function(e,n){let t=n;for(;t<D.length-3;){if(e.startsWith("diff"))return!1;if(D[t].startsWith(u)&&D[t+1].startsWith(p)&&D[t+2].startsWith(g))return!0;t++}return!1}(e,c);if(null===s)throw new Error("Where is my file !!!");(z=m.exec(e))?s.oldMode=z[1]:(z=v.exec(e))?s.newMode=z[1]:(z=w.exec(e))?(s.deletedFileMode=z[1],s.isDeleted=!0):(z=y.exec(e))?(s.newFileMode=z[1],s.isNew=!0):(z=N.exec(e))?(P&&(s.oldName=z[1]),s.isCopy=!0):(z=x.exec(e))?(P&&(s.newName=z[1]),s.isCopy=!0):(z=C.exec(e))?(P&&(s.oldName=z[1]),s.isRename=!0):(z=E.exec(e))?(P&&(s.newName=z[1]),s.isRename=!0):(z=H.exec(e))?(s.isBinary=!0,s.oldName=a(z[1],void 0,t.srcPrefix),s.newName=a(z[2],void 0,t.dstPrefix),A("Binary file")):O.test(e)?(s.isBinary=!0,A(e)):(z=T.exec(e))?s.unchangedPercentage=parseInt(z[1],10):(z=L.exec(e))?s.changedPercentage=parseInt(z[1],10):(z=S.exec(e))?(s.checksumBefore=z[1],s.checksumAfter=z[2],z[3]&&(s.mode=z[3])):(z=j.exec(e))?(s.checksumBefore=[z[2],z[3]],s.checksumAfter=z[1]):(z=I.exec(e))?(s.oldMode=[z[2],z[3]],s.newMode=z[1]):(z=k.exec(e))?(s.newFileMode=z[1],s.isNew=!0):(z=M.exec(e))&&(s.deletedFileMode=z[1],s.isDeleted=!0)})),z(),W(),i}function c(){}function h(e,n,t,i,s){for(var r=0,l=n.length,o=0,a=0;r<l;r++){var d=n[r];if(d.removed){if(d.value=e.join(i.slice(a,a+d.count)),a+=d.count,r&&n[r-1].added){var c=n[r-1];n[r-1]=n[r],n[r]=c}}else{if(!d.added&&s){var h=t.slice(o,o+d.count);h=h.map((function(e,n){var t=i[a+n];return t.length>e.length?t:e})),d.value=e.join(h)}else d.value=e.join(t.slice(o,o+d.count));o+=d.count,d.added||(a+=d.count)}}var f=n[l-1];return l>1&&"string"==typeof f.value&&(f.added||f.removed)&&e.equals("",f.value)&&(n[l-2].value+=f.value,n.pop()),n}c.prototype={diff:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.callback;"function"==typeof t&&(i=t,t={}),this.options=t;var s=this;function r(e){return i?(setTimeout((function(){i(void 0,e)}),0),!0):e}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e));var l=(n=this.removeEmpty(this.tokenize(n))).length,o=e.length,a=1,d=l+o;t.maxEditLength&&(d=Math.min(d,t.maxEditLength));var c=[{newPos:-1,components:[]}],f=this.extractCommon(c[0],n,e,0);if(c[0].newPos+1>=l&&f+1>=o)return r([{value:this.join(n),count:n.length}]);function b(){for(var t=-1*a;t<=a;t+=2){var i=void 0,d=c[t-1],f=c[t+1],b=(f?f.newPos:0)-t;d&&(c[t-1]=void 0);var u=d&&d.newPos+1<l,p=f&&0<=b&&b<o;if(u||p){if(!u||p&&d.newPos<f.newPos?(i={newPos:(g=f).newPos,components:g.components.slice(0)},s.pushComponent(i.components,void 0,!0)):((i=d).newPos++,s.pushComponent(i.components,!0,void 0)),b=s.extractCommon(i,n,e,t),i.newPos+1>=l&&b+1>=o)return r(h(s,i.components,n,e,s.useLongestToken));c[t]=i}else c[t]=void 0}var g;a++}if(i)!function e(){setTimeout((function(){if(a>d)return i();b()||e()}),0)}();else for(;a<=d;){var u=b();if(u)return u}},pushComponent:function(e,n,t){var i=e[e.length-1];i&&i.added===n&&i.removed===t?e[e.length-1]={count:i.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,i){for(var s=n.length,r=t.length,l=e.newPos,o=l-i,a=0;l+1<s&&o+1<r&&this.equals(n[l+1],t[o+1]);)l++,o++,a++;return a&&e.components.push({count:a}),e.newPos=l,o},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var f=new c;var b=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,u=/\S/,p=new c;p.equals=function(e,n){return this.options.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e===n||this.options.ignoreWhitespace&&!u.test(e)&&!u.test(n)},p.tokenize=function(e){for(var n=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<n.length-1;t++)!n[t+1]&&n[t+2]&&b.test(n[t])&&b.test(n[t+2])&&(n[t]+=n[t+2],n.splice(t+1,2),t--);return n};var g=new c;function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}g.tokenize=function(e){var n=[],t=e.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var i=0;i<t.length;i++){var s=t[i];i%2&&!this.options.newlineIsToken?n[n.length-1]+=s:(this.options.ignoreWhitespace&&(s=s.trim()),n.push(s))}return n},(new c).tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)},(new c).tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var v=Object.prototype.toString,w=new c;function y(e,n,t,i,s){var r,l;for(n=n||[],t=t||[],i&&(e=i(s,e)),r=0;r<n.length;r+=1)if(n[r]===e)return t[r];if("[object Array]"===v.call(e)){for(n.push(e),l=new Array(e.length),t.push(l),r=0;r<e.length;r+=1)l[r]=y(e[r],n,t,i,s);return n.pop(),t.pop(),l}if(e&&e.toJSON&&(e=e.toJSON()),"object"===m(e)&&null!==e){n.push(e),l={},t.push(l);var o,a=[];for(o in e)e.hasOwnProperty(o)&&a.push(o);for(a.sort(),r=0;r<a.length;r+=1)l[o=a[r]]=y(e[o],n,t,i,o);n.pop(),t.pop()}else l=e;return l}w.useLongestToken=!0,w.tokenize=g.tokenize,w.castInput=function(e){var n=this.options,t=n.undefinedReplacement,i=n.stringifyReplacer,s=void 0===i?function(e,n){return void 0===n?t:n}:i;return"string"==typeof e?e:JSON.stringify(y(e,null,null,s),s,"  ")},w.equals=function(e,n){return c.prototype.equals.call(w,e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var N=new c;function x(e){return(n,t)=>{const i=e(n).trim(),s=e(t).trim();return function(e,n){if(0===e.length)return n.length;if(0===n.length)return e.length;const t=[];let i,s;for(i=0;i<=n.length;i++)t[i]=[i];for(s=0;s<=e.length;s++)t[0][s]=s;for(i=1;i<=n.length;i++)for(s=1;s<=e.length;s++)n.charAt(i-1)===e.charAt(s-1)?t[i][s]=t[i-1][s-1]:t[i][s]=Math.min(t[i-1][s-1]+1,Math.min(t[i][s-1]+1,t[i-1][s]+1));return t[n.length][e.length]}(i,s)/(i.length+s.length)}}function C(e){return function n(t,i,s=0,r=new Map){const l=function(n,t,i=new Map){let s,r=1/0;for(let l=0;l<n.length;++l)for(let o=0;o<t.length;++o){const a=JSON.stringify([n[l],t[o]]);let d;i.has(a)&&(d=i.get(a))||(d=e(n[l],t[o]),i.set(a,d)),d<r&&(r=d,s={indexA:l,indexB:o,score:r})}return s}(t,i,r);if(!l||t.length+i.length<3)return[[t,i]];const o=t.slice(0,l.indexA),a=i.slice(0,l.indexB),d=[t[l.indexA]],c=[i[l.indexB]],h=l.indexA+1,f=l.indexB+1,b=t.slice(h),u=i.slice(f),p=n(o,a,s+1,r),g=n(d,c,s+1,r),m=n(b,u,s+1,r);let v=g;return(l.indexA>0||l.indexB>0)&&(v=p.concat(v)),(t.length>h||i.length>f)&&(v=v.concat(m)),v}}N.tokenize=function(e){return e.slice()},N.join=N.removeEmpty=function(e){return e};const E={INSERTS:"d2h-ins",DELETES:"d2h-del",CONTEXT:"d2h-cntx",INFO:"d2h-info",INSERT_CHANGES:"d2h-ins d2h-change",DELETE_CHANGES:"d2h-del d2h-change"},T={matching:"none",matchWordsThreshold:.25,maxLineLengthHighlight:1e4,diffStyle:"word",colorScheme:t.LIGHT},L="/",S=x((e=>e.value)),H=C(S);function O(e){return-1!==e.indexOf("dev/null")}function j(e){return e.replace(/(<del[^>]*>((.|\n)*?)<\/del>)/g,"")}function I(e){switch(e){case n.CONTEXT:return E.CONTEXT;case n.INSERT:return E.INSERTS;case n.DELETE:return E.DELETES}}function k(e){switch(e){case t.DARK:return"d2h-dark-color-scheme";case t.AUTO:return"d2h-auto-color-scheme";case t.LIGHT:default:return"d2h-light-color-scheme"}}function M(e){return e.slice(0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function D(e,n,t=!0){const i=function(e){return e?2:1}(n);return{prefix:e.substring(0,i),content:t?M(e.substring(i)):e.substring(i)}}function z(e){const n=s(e.oldName),t=s(e.newName);if(n===t||O(n)||O(t))return O(t)?n:t;{const e=[],i=[],s=n.split(L),r=t.split(L);let l=0,o=s.length-1,a=r.length-1;for(;l<o&&l<a&&s[l]===r[l];)e.push(r[l]),l+=1;for(;o>l&&a>l&&s[o]===r[a];)i.unshift(r[a]),o-=1,a-=1;const d=e.join(L),c=i.join(L),h=s.slice(l,o+1).join(L),f=r.slice(l,a+1).join(L);return d.length&&c.length?d+L+"{"+h+" → "+f+"}"+L+c:d.length?d+L+"{"+h+" → "+f+"}":c.length?"{"+h+" → "+f+"}"+L+c:n+" → "+t}}function W(e){return`d2h-${function(e){let n,t,i,s=0;for(n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),s=(s<<5)-s+t,s|=0;return s}(z(e)).toString().slice(-6)}`}function F(e){let n="file-changed";return e.isRename||e.isCopy?n="file-renamed":e.isNew?n="file-added":e.isDeleted?n="file-deleted":e.newName!==e.oldName&&(n="file-renamed"),n}function A(e,n,t,i={}){const{matching:s,maxLineLengthHighlight:r,matchWordsThreshold:l,diffStyle:o}=Object.assign(Object.assign({},T),i),a=D(e,t,!1),d=D(n,t,!1);if(a.content.length>r||d.content.length>r)return{oldLine:{prefix:a.prefix,content:M(a.content)},newLine:{prefix:d.prefix,content:M(d.content)}};const c="char"===o?(h=a.content,b=d.content,f.diff(h,b,u)):function(e,n,t){return p.diff(e,n,t)}(a.content,d.content);var h,b,u;const g=[];if("word"===o&&"words"===s){const e=c.filter((e=>e.removed)),n=c.filter((e=>e.added));H(n,e).forEach((e=>{if(1===e[0].length&&1===e[1].length){S(e[0][0],e[1][0])<l&&(g.push(e[0][0]),g.push(e[1][0]))}}))}const m=c.reduce(((e,n)=>{const t=n.added?"ins":n.removed?"del":null,i=g.indexOf(n)>-1?' class="d2h-change"':"",s=M(n.value);return null!==t?`${e}<${t}${i}>${s}</${t}>`:`${e}${s}`}),"");return{oldLine:{prefix:a.prefix,content:(v=m,v.replace(/(<ins[^>]*>((.|\n)*?)<\/ins>)/g,""))},newLine:{prefix:d.prefix,content:j(m)}};var v}const B="file-summary",R={colorScheme:T.colorScheme};class P{constructor(e,n={}){this.hoganUtils=e,this.config=Object.assign(Object.assign({},R),n)}render(e){const n=e.map((e=>this.hoganUtils.render(B,"line",{fileHtmlId:W(e),oldName:e.oldName,newName:e.newName,fileName:z(e),deletedLines:"-"+e.deletedLines,addedLines:"+"+e.addedLines},{fileIcon:this.hoganUtils.template("icon",F(e))}))).join("\n");return this.hoganUtils.render(B,"wrapper",{colorScheme:k(this.config.colorScheme),filesNumber:e.length,files:n})}}const U=Object.assign(Object.assign({},T),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),$="generic",G="line-by-line";class V{constructor(e,n={}){this.hoganUtils=e,this.config=Object.assign(Object.assign({},U),n)}render(e){const n=e.map((e=>{let n;return n=e.blocks.length?this.generateFileHtml(e):this.generateEmptyDiff(),this.makeFileDiffHtml(e,n)})).join("\n");return this.hoganUtils.render($,"wrapper",{colorScheme:k(this.config.colorScheme),content:n})}makeFileDiffHtml(e,n){if(this.config.renderNothingWhenEmpty&&Array.isArray(e.blocks)&&0===e.blocks.length)return"";const t=this.hoganUtils.template(G,"file-diff"),i=this.hoganUtils.template($,"file-path"),s=this.hoganUtils.template("icon","file"),r=this.hoganUtils.template("tag",F(e));return t.render({file:e,fileHtmlId:W(e),diffs:n,filePath:i.render({fileDiffName:z(e)},{fileIcon:s,fileTag:r})})}generateEmptyDiff(){return this.hoganUtils.render($,"empty-diff",{contentClass:"d2h-code-line",CSSLineClass:E})}generateFileHtml(e){const n=C(x((n=>D(n.content,e.isCombined).content)));return e.blocks.map((t=>{let i=this.hoganUtils.render($,"block-header",{CSSLineClass:E,blockHeader:e.isTooBig?t.header:M(t.header),lineClass:"d2h-code-linenumber",contentClass:"d2h-code-line"});return this.applyLineGroupping(t).forEach((([t,s,r])=>{if(s.length&&r.length&&!t.length)this.applyRematchMatching(s,r,n).map((([n,t])=>{const{left:s,right:r}=this.processChangedLines(e,e.isCombined,n,t);i+=s,i+=r}));else if(t.length)t.forEach((n=>{const{prefix:t,content:s}=D(n.content,e.isCombined);i+=this.generateSingleLineHtml(e,{type:E.CONTEXT,prefix:t,content:s,oldNumber:n.oldNumber,newNumber:n.newNumber})}));else if(s.length||r.length){const{left:n,right:t}=this.processChangedLines(e,e.isCombined,s,r);i+=n,i+=t}})),i})).join("\n")}applyLineGroupping(e){const t=[];let i=[],s=[];for(let r=0;r<e.lines.length;r++){const l=e.lines[r];(l.type!==n.INSERT&&s.length||l.type===n.CONTEXT&&i.length>0)&&(t.push([[],i,s]),i=[],s=[]),l.type===n.CONTEXT?t.push([[l],[],[]]):l.type===n.INSERT&&0===i.length?t.push([[],[],[l]]):l.type===n.INSERT&&i.length>0?s.push(l):l.type===n.DELETE&&i.push(l)}return(i.length||s.length)&&(t.push([[],i,s]),i=[],s=[]),t}applyRematchMatching(e,n,t){const i=e.length*n.length,s=Math.max.apply(null,[0].concat(e.concat(n).map((e=>e.content.length))));return i<this.config.matchingMaxComparisons&&s<this.config.maxLineSizeInBlockForComparison&&("lines"===this.config.matching||"words"===this.config.matching)?t(e,n):[[e,n]]}processChangedLines(e,n,t,i){const s={right:"",left:""},r=Math.max(t.length,i.length);for(let l=0;l<r;l++){const r=t[l],o=i[l],a=void 0!==r&&void 0!==o?A(r.content,o.content,n,this.config):void 0,d=void 0!==r&&void 0!==r.oldNumber?Object.assign(Object.assign({},void 0!==a?{prefix:a.oldLine.prefix,content:a.oldLine.content,type:E.DELETE_CHANGES}:Object.assign(Object.assign({},D(r.content,n)),{type:I(r.type)})),{oldNumber:r.oldNumber,newNumber:r.newNumber}):void 0,c=void 0!==o&&void 0!==o.newNumber?Object.assign(Object.assign({},void 0!==a?{prefix:a.newLine.prefix,content:a.newLine.content,type:E.INSERT_CHANGES}:Object.assign(Object.assign({},D(o.content,n)),{type:I(o.type)})),{oldNumber:o.oldNumber,newNumber:o.newNumber}):void 0,{left:h,right:f}=this.generateLineHtml(e,d,c);s.left+=h,s.right+=f}return s}generateLineHtml(e,n,t){return{left:this.generateSingleLineHtml(e,n),right:this.generateSingleLineHtml(e,t)}}generateSingleLineHtml(e,n){if(void 0===n)return"";const t=this.hoganUtils.render(G,"numbers",{oldNumber:n.oldNumber||"",newNumber:n.newNumber||""});return this.hoganUtils.render($,"line",{type:n.type,lineClass:"d2h-code-linenumber",contentClass:"d2h-code-line",prefix:" "===n.prefix?"&nbsp;":n.prefix,content:n.content,lineNumber:t,line:n,file:e})}}const X=Object.assign(Object.assign({},T),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),q="generic";class _{constructor(e,n={}){this.hoganUtils=e,this.config=Object.assign(Object.assign({},X),n)}render(e){const n=e.map((e=>{let n;return n=e.blocks.length?this.generateFileHtml(e):this.generateEmptyDiff(),this.makeFileDiffHtml(e,n)})).join("\n");return this.hoganUtils.render(q,"wrapper",{colorScheme:k(this.config.colorScheme),content:n})}makeFileDiffHtml(e,n){if(this.config.renderNothingWhenEmpty&&Array.isArray(e.blocks)&&0===e.blocks.length)return"";const t=this.hoganUtils.template("side-by-side","file-diff"),i=this.hoganUtils.template(q,"file-path"),s=this.hoganUtils.template("icon","file"),r=this.hoganUtils.template("tag",F(e));return t.render({file:e,fileHtmlId:W(e),diffs:n,filePath:i.render({fileDiffName:z(e)},{fileIcon:s,fileTag:r})})}generateEmptyDiff(){return{right:"",left:this.hoganUtils.render(q,"empty-diff",{contentClass:"d2h-code-side-line",CSSLineClass:E})}}generateFileHtml(e){const n=C(x((n=>D(n.content,e.isCombined).content)));return e.blocks.map((t=>{const i={left:this.makeHeaderHtml(t.header,e),right:this.makeHeaderHtml("")};return this.applyLineGroupping(t).forEach((([t,s,r])=>{if(s.length&&r.length&&!t.length)this.applyRematchMatching(s,r,n).map((([n,t])=>{const{left:s,right:r}=this.processChangedLines(e.isCombined,n,t);i.left+=s,i.right+=r}));else if(t.length)t.forEach((n=>{const{prefix:t,content:s}=D(n.content,e.isCombined),{left:r,right:l}=this.generateLineHtml({type:E.CONTEXT,prefix:t,content:s,number:n.oldNumber},{type:E.CONTEXT,prefix:t,content:s,number:n.newNumber});i.left+=r,i.right+=l}));else if(s.length||r.length){const{left:n,right:t}=this.processChangedLines(e.isCombined,s,r);i.left+=n,i.right+=t}})),i})).reduce(((e,n)=>({left:e.left+n.left,right:e.right+n.right})),{left:"",right:""})}applyLineGroupping(e){const t=[];let i=[],s=[];for(let r=0;r<e.lines.length;r++){const l=e.lines[r];(l.type!==n.INSERT&&s.length||l.type===n.CONTEXT&&i.length>0)&&(t.push([[],i,s]),i=[],s=[]),l.type===n.CONTEXT?t.push([[l],[],[]]):l.type===n.INSERT&&0===i.length?t.push([[],[],[l]]):l.type===n.INSERT&&i.length>0?s.push(l):l.type===n.DELETE&&i.push(l)}return(i.length||s.length)&&(t.push([[],i,s]),i=[],s=[]),t}applyRematchMatching(e,n,t){const i=e.length*n.length,s=Math.max.apply(null,[0].concat(e.concat(n).map((e=>e.content.length))));return i<this.config.matchingMaxComparisons&&s<this.config.maxLineSizeInBlockForComparison&&("lines"===this.config.matching||"words"===this.config.matching)?t(e,n):[[e,n]]}makeHeaderHtml(e,n){return this.hoganUtils.render(q,"block-header",{CSSLineClass:E,blockHeader:(null==n?void 0:n.isTooBig)?e:M(e),lineClass:"d2h-code-side-linenumber",contentClass:"d2h-code-side-line"})}processChangedLines(e,n,t){const i={right:"",left:""},s=Math.max(n.length,t.length);for(let r=0;r<s;r++){const s=n[r],l=t[r],o=void 0!==s&&void 0!==l?A(s.content,l.content,e,this.config):void 0,a=void 0!==s&&void 0!==s.oldNumber?Object.assign(Object.assign({},void 0!==o?{prefix:o.oldLine.prefix,content:o.oldLine.content,type:E.DELETE_CHANGES}:Object.assign(Object.assign({},D(s.content,e)),{type:I(s.type)})),{number:s.oldNumber}):void 0,d=void 0!==l&&void 0!==l.newNumber?Object.assign(Object.assign({},void 0!==o?{prefix:o.newLine.prefix,content:o.newLine.content,type:E.INSERT_CHANGES}:Object.assign(Object.assign({},D(l.content,e)),{type:I(l.type)})),{number:l.newNumber}):void 0,{left:c,right:h}=this.generateLineHtml(a,d);i.left+=c,i.right+=h}return i}generateLineHtml(e,n){return{left:this.generateSingleHtml(e),right:this.generateSingleHtml(n)}}generateSingleHtml(e){const n="d2h-code-side-linenumber",t="d2h-code-side-line";return this.hoganUtils.render(q,"line",{type:(null==e?void 0:e.type)||`${E.CONTEXT} d2h-emptyplaceholder`,lineClass:void 0!==e?n:`${n} d2h-code-side-emptyplaceholder`,contentClass:void 0!==e?t:`${t} d2h-code-side-emptyplaceholder`,prefix:" "===(null==e?void 0:e.prefix)?"&nbsp;":null==e?void 0:e.prefix,content:null==e?void 0:e.content,lineNumber:null==e?void 0:e.number})}}const K={};K["file-summary-line"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<li class="d2h-file-list-line">'),i.b("\n"+t),i.b('    <span class="d2h-file-name-wrapper">'),i.b("\n"+t),i.b(i.rp("<fileIcon0",e,n,"      ")),i.b('      <a href="#'),i.b(i.v(i.f("fileHtmlId",e,n,0))),i.b('" class="d2h-file-name">'),i.b(i.v(i.f("fileName",e,n,0))),i.b("</a>"),i.b("\n"+t),i.b('      <span class="d2h-file-stats">'),i.b("\n"+t),i.b('          <span class="d2h-lines-added">'),i.b(i.v(i.f("addedLines",e,n,0))),i.b("</span>"),i.b("\n"+t),i.b('          <span class="d2h-lines-deleted">'),i.b(i.v(i.f("deletedLines",e,n,0))),i.b("</span>"),i.b("\n"+t),i.b("      </span>"),i.b("\n"+t),i.b("    </span>"),i.b("\n"+t),i.b("</li>"),i.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}}},subs:{}}),K["file-summary-wrapper"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<div class="d2h-file-list-wrapper '),i.b(i.v(i.f("colorScheme",e,n,0))),i.b('">'),i.b("\n"+t),i.b('    <div class="d2h-file-list-header">'),i.b("\n"+t),i.b('        <span class="d2h-file-list-title">Files changed ('),i.b(i.v(i.f("filesNumber",e,n,0))),i.b(")</span>"),i.b("\n"+t),i.b('        <a class="d2h-file-switch d2h-hide">hide</a>'),i.b("\n"+t),i.b('        <a class="d2h-file-switch d2h-show">show</a>'),i.b("\n"+t),i.b("    </div>"),i.b("\n"+t),i.b('    <ol class="d2h-file-list">'),i.b("\n"+t),i.b("    "),i.b(i.t(i.f("files",e,n,0))),i.b("\n"+t),i.b("    </ol>"),i.b("\n"+t),i.b("</div>"),i.fl()},partials:{},subs:{}}),K["generic-block-header"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b("<tr>"),i.b("\n"+t),i.b('    <td class="'),i.b(i.v(i.f("lineClass",e,n,0))),i.b(" "),i.b(i.v(i.d("CSSLineClass.INFO",e,n,0))),i.b('"></td>'),i.b("\n"+t),i.b('    <td class="'),i.b(i.v(i.d("CSSLineClass.INFO",e,n,0))),i.b('">'),i.b("\n"+t),i.b('        <div class="'),i.b(i.v(i.f("contentClass",e,n,0))),i.b('">'),i.s(i.f("blockHeader",e,n,1),e,n,0,156,173,"{{ }}")&&(i.rs(e,n,(function(e,n,t){t.b(t.t(t.f("blockHeader",e,n,0)))})),e.pop()),i.s(i.f("blockHeader",e,n,1),e,n,1,0,0,"")||i.b("&nbsp;"),i.b("</div>"),i.b("\n"+t),i.b("    </td>"),i.b("\n"+t),i.b("</tr>"),i.fl()},partials:{},subs:{}}),K["generic-empty-diff"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b("<tr>"),i.b("\n"+t),i.b('    <td class="'),i.b(i.v(i.d("CSSLineClass.INFO",e,n,0))),i.b('">'),i.b("\n"+t),i.b('        <div class="'),i.b(i.v(i.f("contentClass",e,n,0))),i.b('">'),i.b("\n"+t),i.b("            File without changes"),i.b("\n"+t),i.b("        </div>"),i.b("\n"+t),i.b("    </td>"),i.b("\n"+t),i.b("</tr>"),i.fl()},partials:{},subs:{}}),K["generic-file-path"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<span class="d2h-file-name-wrapper">'),i.b("\n"+t),i.b(i.rp("<fileIcon0",e,n,"    ")),i.b('    <span class="d2h-file-name">'),i.b(i.v(i.f("fileDiffName",e,n,0))),i.b("</span>"),i.b("\n"+t),i.b(i.rp("<fileTag1",e,n,"    ")),i.b("</span>"),i.b("\n"+t),i.b('<label class="d2h-file-collapse">'),i.b("\n"+t),i.b('    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">'),i.b("\n"+t),i.b("    Viewed"),i.b("\n"+t),i.b("</label>"),i.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}},"<fileTag1":{name:"fileTag",partials:{},subs:{}}},subs:{}}),K["generic-line"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b("<tr>"),i.b("\n"+t),i.b('    <td class="'),i.b(i.v(i.f("lineClass",e,n,0))),i.b(" "),i.b(i.v(i.f("type",e,n,0))),i.b('">'),i.b("\n"+t),i.b("      "),i.b(i.t(i.f("lineNumber",e,n,0))),i.b("\n"+t),i.b("    </td>"),i.b("\n"+t),i.b('    <td class="'),i.b(i.v(i.f("type",e,n,0))),i.b('">'),i.b("\n"+t),i.b('        <div class="'),i.b(i.v(i.f("contentClass",e,n,0))),i.b('">'),i.b("\n"+t),i.s(i.f("prefix",e,n,1),e,n,0,162,238,"{{ }}")&&(i.rs(e,n,(function(e,n,i){i.b('            <span class="d2h-code-line-prefix">'),i.b(i.t(i.f("prefix",e,n,0))),i.b("</span>"),i.b("\n"+t)})),e.pop()),i.s(i.f("prefix",e,n,1),e,n,1,0,0,"")||(i.b('            <span class="d2h-code-line-prefix">&nbsp;</span>'),i.b("\n"+t)),i.s(i.f("content",e,n,1),e,n,0,371,445,"{{ }}")&&(i.rs(e,n,(function(e,n,i){i.b('            <span class="d2h-code-line-ctn">'),i.b(i.t(i.f("content",e,n,0))),i.b("</span>"),i.b("\n"+t)})),e.pop()),i.s(i.f("content",e,n,1),e,n,1,0,0,"")||(i.b('            <span class="d2h-code-line-ctn"><br></span>'),i.b("\n"+t)),i.b("        </div>"),i.b("\n"+t),i.b("    </td>"),i.b("\n"+t),i.b("</tr>"),i.fl()},partials:{},subs:{}}),K["generic-wrapper"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<div class="d2h-wrapper '),i.b(i.v(i.f("colorScheme",e,n,0))),i.b('">'),i.b("\n"+t),i.b("    "),i.b(i.t(i.f("content",e,n,0))),i.b("\n"+t),i.b("</div>"),i.fl()},partials:{},subs:{}}),K["icon-file-added"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<svg aria-hidden="true" class="d2h-icon d2h-added" height="16" title="added" version="1.1" viewBox="0 0 14 16"'),i.b("\n"+t),i.b('     width="14">'),i.b("\n"+t),i.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z"></path>'),i.b("\n"+t),i.b("</svg>"),i.fl()},partials:{},subs:{}}),K["icon-file-changed"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"'),i.b("\n"+t),i.b('     viewBox="0 0 14 16" width="14">'),i.b("\n"+t),i.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>'),i.b("\n"+t),i.b("</svg>"),i.fl()},partials:{},subs:{}}),K["icon-file-deleted"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<svg aria-hidden="true" class="d2h-icon d2h-deleted" height="16" title="removed" version="1.1"'),i.b("\n"+t),i.b('     viewBox="0 0 14 16" width="14">'),i.b("\n"+t),i.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM11 9H3V7h8v2z"></path>'),i.b("\n"+t),i.b("</svg>"),i.fl()},partials:{},subs:{}}),K["icon-file-renamed"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<svg aria-hidden="true" class="d2h-icon d2h-moved" height="16" title="renamed" version="1.1"'),i.b("\n"+t),i.b('     viewBox="0 0 14 16" width="14">'),i.b("\n"+t),i.b('    <path d="M6 9H3V7h3V4l5 4-5 4V9z m8-7v12c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h12c0.55 0 1 0.45 1 1z m-1 0H1v12h12V2z"></path>'),i.b("\n"+t),i.b("</svg>"),i.fl()},partials:{},subs:{}}),K["icon-file"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">'),i.b("\n"+t),i.b('    <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>'),i.b("\n"+t),i.b("</svg>"),i.fl()},partials:{},subs:{}}),K["line-by-line-file-diff"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<div id="'),i.b(i.v(i.f("fileHtmlId",e,n,0))),i.b('" class="d2h-file-wrapper" data-lang="'),i.b(i.v(i.d("file.language",e,n,0))),i.b('">'),i.b("\n"+t),i.b('    <div class="d2h-file-header">'),i.b("\n"+t),i.b("    "),i.b(i.t(i.f("filePath",e,n,0))),i.b("\n"+t),i.b("    </div>"),i.b("\n"+t),i.b('    <div class="d2h-file-diff">'),i.b("\n"+t),i.b('        <div class="d2h-code-wrapper">'),i.b("\n"+t),i.b('            <table class="d2h-diff-table">'),i.b("\n"+t),i.b('                <tbody class="d2h-diff-tbody">'),i.b("\n"+t),i.b("                "),i.b(i.t(i.f("diffs",e,n,0))),i.b("\n"+t),i.b("                </tbody>"),i.b("\n"+t),i.b("            </table>"),i.b("\n"+t),i.b("        </div>"),i.b("\n"+t),i.b("    </div>"),i.b("\n"+t),i.b("</div>"),i.fl()},partials:{},subs:{}}),K["line-by-line-numbers"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<div class="line-num1">'),i.b(i.v(i.f("oldNumber",e,n,0))),i.b("</div>"),i.b("\n"+t),i.b('<div class="line-num2">'),i.b(i.v(i.f("newNumber",e,n,0))),i.b("</div>"),i.fl()},partials:{},subs:{}}),K["side-by-side-file-diff"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<div id="'),i.b(i.v(i.f("fileHtmlId",e,n,0))),i.b('" class="d2h-file-wrapper" data-lang="'),i.b(i.v(i.d("file.language",e,n,0))),i.b('">'),i.b("\n"+t),i.b('    <div class="d2h-file-header">'),i.b("\n"+t),i.b("      "),i.b(i.t(i.f("filePath",e,n,0))),i.b("\n"+t),i.b("    </div>"),i.b("\n"+t),i.b('    <div class="d2h-files-diff">'),i.b("\n"+t),i.b('        <div class="d2h-file-side-diff">'),i.b("\n"+t),i.b('            <div class="d2h-code-wrapper">'),i.b("\n"+t),i.b('                <table class="d2h-diff-table">'),i.b("\n"+t),i.b('                    <tbody class="d2h-diff-tbody">'),i.b("\n"+t),i.b("                    "),i.b(i.t(i.d("diffs.left",e,n,0))),i.b("\n"+t),i.b("                    </tbody>"),i.b("\n"+t),i.b("                </table>"),i.b("\n"+t),i.b("            </div>"),i.b("\n"+t),i.b("        </div>"),i.b("\n"+t),i.b('        <div class="d2h-file-side-diff">'),i.b("\n"+t),i.b('            <div class="d2h-code-wrapper">'),i.b("\n"+t),i.b('                <table class="d2h-diff-table">'),i.b("\n"+t),i.b('                    <tbody class="d2h-diff-tbody">'),i.b("\n"+t),i.b("                    "),i.b(i.t(i.d("diffs.right",e,n,0))),i.b("\n"+t),i.b("                    </tbody>"),i.b("\n"+t),i.b("                </table>"),i.b("\n"+t),i.b("            </div>"),i.b("\n"+t),i.b("        </div>"),i.b("\n"+t),i.b("    </div>"),i.b("\n"+t),i.b("</div>"),i.fl()},partials:{},subs:{}}),K["tag-file-added"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<span class="d2h-tag d2h-added d2h-added-tag">ADDED</span>'),i.fl()},partials:{},subs:{}}),K["tag-file-changed"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span>'),i.fl()},partials:{},subs:{}}),K["tag-file-deleted"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<span class="d2h-tag d2h-deleted d2h-deleted-tag">DELETED</span>'),i.fl()},partials:{},subs:{}}),K["tag-file-renamed"]=new e.Template({code:function(e,n,t){var i=this;return i.b(t=t||""),i.b('<span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>'),i.fl()},partials:{},subs:{}});class J{constructor({compiledTemplates:n={},rawTemplates:t={}}){const i=Object.entries(t).reduce(((n,[t,i])=>{const s=e.compile(i,{asString:!1});return Object.assign(Object.assign({},n),{[t]:s})}),{});this.preCompiledTemplates=Object.assign(Object.assign(Object.assign({},K),n),i)}static compile(n){return e.compile(n,{asString:!1})}render(e,n,t,i,s){const r=this.templateKey(e,n);try{return this.preCompiledTemplates[r].render(t,i,s)}catch(l){throw new Error(`Could not find template to render '${r}'`)}}template(e,n){return this.preCompiledTemplates[this.templateKey(e,n)]}templateKey(e,n){return`${e}-${n}`}}const Z=Object.assign(Object.assign(Object.assign({},U),X),{outputFormat:"line-by-line",drawFileList:!0});function Q(e,n={}){const t=Object.assign(Object.assign({},Z),n),i="string"==typeof e?d(e,t):e,s=new J(t),{colorScheme:r}=t,l={colorScheme:r};return(t.drawFileList?new P(s,l).render(i):"")+("side-by-side"===t.outputFormat?new _(s,t).render(i):new V(s,t).render(i))}export{Q as h};
