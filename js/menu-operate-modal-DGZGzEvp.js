import{_ as e}from"./lodash-DG05lPuJ.js";import a from"./menu-tree-select-YZkmdXou.js";import{m as l}from"./menu-api-DyF2x50w.js";import{I as n}from"./index-Cova5QGk.js";import{_ as t,V as u,M as r,W as s,S as d,s as o}from"./index-SeYMZHv7.js";import{b as i}from"./ant-design-vue-qdrtx42b.js";import{r as m,a as c,b2 as p,ag as v,o as h,bz as f,c as b,ai as y,u as g,b as k,ah as j,F as _,b0 as T,J as U,be as I,b3 as F,n as x}from"./@vue-wTDZSr7R.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-Dk7pxPyP.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const w={class:"footer"},M=t({__name:"menu-operate-modal",emits:["reloadList"],setup(t,{expose:M,emit:N}){const C=N,P=m(!1),O=m(),E=m();function S(){x((()=>{O.value&&O.value.queryMenuTree(),E.value&&E.value.queryMenuTree()}))}function q(){Object.assign(V,L),A.value.resetFields(),P.value=!1}const A=m(),L={menuId:void 0,menuName:void 0,menuType:r.CATALOG.value,icon:void 0,parentId:void 0,path:void 0,permsType:u.SA_TOKEN.value,webPerms:void 0,apiPerms:void 0,sort:void 0,visibleFlag:!0,cacheFlag:!1,component:void 0,contextMenuId:void 0,disabledFlag:!1,frameFlag:!1,frameUrl:void 0};let V=c({...L});const z={menuType:[{required:!0,message:"菜单类型不能为空"}],permsType:[{required:!0,message:"权限类型不能为空"}],menuName:[{required:!0,message:"菜单名称不能为空"},{max:20,message:"菜单名称不能大于20个字符",trigger:"blur"}],frameUrl:[{required:!0,message:"外链地址不能为空"},{max:500,message:"外链地址不能大于500个字符",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空"},{max:100,message:"路由地址不能大于100个字符",trigger:"blur"}]};const D=async a=>{let n=await function(e){return new Promise((a=>{e.validate().then((()=>{a(!0)})).catch((()=>{a(!1)}))}))}(A.value);if(n){d.show();try{let n=e.cloneDeep(V);n.parentId||(n.parentId=0),n.menuId?await l.updateMenu(n):await l.addMenu(n),i.success((n.menuId?"修改":"添加")+"成功"),a?function(){S();const e=V.menuType,a=V.parentId,l=V.webPerms;Object.assign(V,L),A.value.resetFields(),V.menuType=e,V.parentId=a,V.menuType===r.POINTS.value&&(V.contextMenuId=a),l&&l.lastIndexOf(":")&&(V.webPerms=l.substring(0,l.lastIndexOf(":")+1))}():q(),C("reloadList")}catch(t){o.captureError(t)}finally{d.hide()}}else i.error("参数验证错误，请仔细填写表单数据!")};function G(e){V.icon=e}return M({showDrawer:async function(a){Object.assign(V,L),a&&!e.isEmpty(a)&&(Object.assign(V,a),V.parentId===s&&(V.parentId=null)),P.value=!0,S()}}),(e,l)=>{const t=p("a-radio-button"),s=p("a-radio-group"),d=p("a-form-item"),o=p("a-input"),i=p("a-switch"),m=p("a-radio"),c=p("a-input-number"),x=p("a-form"),M=p("a-button"),N=p("a-drawer");return h(),v(N,{"body-style":{paddingBottom:"80px"},maskClosable:!0,title:g(V).menuId?"编辑":"添加",open:P.value,width:600,onClose:q,destroyOnClose:""},{default:f((()=>[b(x,{ref_key:"formRef",ref:A,labelCol:{span:5},labelWrap:!0,model:g(V),rules:z},{default:f((()=>[b(d,{label:"菜单类型",name:"menuType"},{default:f((()=>[b(s,{value:g(V).menuType,"onUpdate:value":l[0]||(l[0]=e=>g(V).menuType=e),"button-style":"solid"},{default:f((()=>[(h(!0),k(_,null,T(g(r),(e=>(h(),v(t,{key:e.value,value:e.value},{default:f((()=>[U(I(e.desc),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),b(d,{label:g(V).menuType===g(r).CATALOG.value?"上级目录":"上级菜单"},{default:f((()=>[b(a,{ref_key:"parentMenuTreeSelect",ref:E,value:g(V).parentId,"onUpdate:value":l[1]||(l[1]=e=>g(V).parentId=e)},null,8,["value"])])),_:1},8,["label"]),g(V).menuType===g(r).CATALOG.value||g(V).menuType===g(r).MENU.value?(h(),k(_,{key:0},[b(d,{label:"菜单名称",name:"menuName"},{default:f((()=>[b(o,{value:g(V).menuName,"onUpdate:value":l[2]||(l[2]=e=>g(V).menuName=e),placeholder:"请输入菜单名称"},null,8,["value"])])),_:1}),b(d,{label:"菜单图标",name:"icon"},{default:f((()=>[b(n,{onUpdateIcon:G},{iconSelect:f((()=>[b(o,{value:g(V).icon,"onUpdate:value":l[3]||(l[3]=e=>g(V).icon=e),placeholder:"请输入菜单图标",style:{width:"200px"}},null,8,["value"]),(h(),v(F(e.$antIcons[g(V).icon]),{class:"smart-margin-left15",style:{"font-size":"20px"}}))])),_:1})])),_:1}),g(V).menuType===g(r).MENU.value?(h(),v(d,{key:0,label:"路由地址",name:"path"},{default:f((()=>[b(o,{value:g(V).path,"onUpdate:value":l[4]||(l[4]=e=>g(V).path=e),placeholder:"请输入路由地址"},null,8,["value"])])),_:1})):j("",!0),g(V).menuType===g(r).MENU.value?(h(),k(_,{key:1},[g(V).frameFlag?(h(),v(d,{key:0,label:"外链地址",name:"frameUrl"},{default:f((()=>[b(o,{value:g(V).frameUrl,"onUpdate:value":l[5]||(l[5]=e=>g(V).frameUrl=e),placeholder:"请输入外链地址"},null,8,["value"])])),_:1})):(h(),v(d,{key:1,label:"组件地址",name:"component",help:"比如 商品列表：/business/erp/goods/goods-list.vue"},{default:f((()=>[b(o,{value:g(V).component,"onUpdate:value":l[6]||(l[6]=e=>g(V).component=e),placeholder:"请输入组件地址 默认带有开头/@/views"},null,8,["value"])])),_:1}))],64)):j("",!0),g(V).menuType===g(r).MENU.value?(h(),v(d,{key:2,label:"是否缓存",name:"cacheFlag"},{default:f((()=>[b(i,{checked:g(V).cacheFlag,"onUpdate:checked":l[7]||(l[7]=e=>g(V).cacheFlag=e),"checked-children":"开启缓存","un-checked-children":"不缓存"},null,8,["checked"])])),_:1})):j("",!0),g(V).menuType===g(r).MENU.value?(h(),v(d,{key:3,label:"是否外链",name:"frameFlag"},{default:f((()=>[b(i,{checked:g(V).frameFlag,"onUpdate:checked":l[8]||(l[8]=e=>g(V).frameFlag=e),"checked-children":"是外链","un-checked-children":"不是外链"},null,8,["checked"])])),_:1})):j("",!0),b(d,{label:"显示状态",name:"visibleFlag"},{default:f((()=>[b(i,{checked:g(V).visibleFlag,"onUpdate:checked":l[9]||(l[9]=e=>g(V).visibleFlag=e),"checked-children":"显示","un-checked-children":"不显示"},null,8,["checked"])])),_:1}),b(d,{label:"禁用状态",name:"disabledFlag"},{default:f((()=>[b(i,{checked:g(V).disabledFlag,"onUpdate:checked":l[10]||(l[10]=e=>g(V).disabledFlag=e),checkedValue:!1,unCheckedValue:!0,"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])])),_:1})],64)):j("",!0),g(V).menuType===g(r).POINTS.value?(h(),k(_,{key:1},[b(d,{label:"功能点名称",name:"menuName"},{default:f((()=>[b(o,{value:g(V).menuName,"onUpdate:value":l[11]||(l[11]=e=>g(V).menuName=e),placeholder:"请输入功能点名称"},null,8,["value"])])),_:1}),b(d,{label:"功能点关联菜单"},{default:f((()=>[b(a,{ref_key:"contextMenuTreeSelect",ref:O,value:g(V).contextMenuId,"onUpdate:value":l[12]||(l[12]=e=>g(V).contextMenuId=e)},null,8,["value"])])),_:1}),b(d,{label:"功能点状态",name:"funcDisabledFlag"},{default:f((()=>[b(i,{checked:g(V).disabledFlag,"onUpdate:checked":l[13]||(l[13]=e=>g(V).disabledFlag=e),checkedValue:!1,unCheckedValue:!0,"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])])),_:1}),b(d,{label:"权限类型",name:"permsType"},{default:f((()=>[b(s,{value:g(V).permsType,"onUpdate:value":l[14]||(l[14]=e=>g(V).permsType=e)},{default:f((()=>[(h(!0),k(_,null,T(g(u),(e=>(h(),v(m,{key:e.value,value:e.value},{default:f((()=>[U(I(e.desc),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),b(d,{label:"前端权限",name:"webPerms",help:"用于前端按钮等功能的展示和隐藏，搭配v-privilege使用"},{default:f((()=>[b(o,{value:g(V).webPerms,"onUpdate:value":l[15]||(l[15]=e=>g(V).webPerms=e),placeholder:"请输入前端权限"},null,8,["value"])])),_:1}),b(d,{label:"后端权限",name:"apiPerms",help:"后端@SaCheckPermission中的权限字符串，多个以英文逗号,分割"},{default:f((()=>[b(o,{value:g(V).apiPerms,"onUpdate:value":l[16]||(l[16]=e=>g(V).apiPerms=e),placeholder:"请输入后端权限"},null,8,["value"])])),_:1})],64)):j("",!0),b(d,{label:"排序",name:"sort",help:"值越小越靠前"},{default:f((()=>[b(c,{value:g(V).sort,"onUpdate:value":l[17]||(l[17]=e=>g(V).sort=e),min:0,placeholder:"请输入排序",style:{width:"100px"}},null,8,["value"])])),_:1})])),_:1},8,["model"]),y("div",w,[b(M,{style:{"margin-right":"8px"},onClick:q},{default:f((()=>[U("取消")])),_:1}),b(M,{style:{"margin-right":"8px"},type:"primary",onClick:l[18]||(l[18]=e=>D(!1))},{default:f((()=>[U("提交 ")])),_:1}),g(V).menuId?j("",!0):(h(),v(M,{key:0,type:"primary",onClick:l[19]||(l[19]=e=>D(!0))},{default:f((()=>[U("提交并添加下一个 ")])),_:1}))])])),_:1},8,["title","open"])}}},[["__scopeId","data-v-c29d2b42"]]);export{M as default};
