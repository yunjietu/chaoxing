import{_ as e}from"./lodash-DG05lPuJ.js";import{_ as a,B as l,S as t,e as o,s as r}from"./index-SeYMZHv7.js";import{r as s}from"./role-api-BdA7V71d.js";import{_ as i}from"./index-D6sqxCCk.js";import d from"./index-DPBcXeae.js";import{_ as n}from"./index-BLMPELrm.js";import{r as m}from"./regular-const-Uc_6Drqv.js";import{b as u}from"./ant-design-vue-qdrtx42b.js";import{r as p,a as c,b2 as v,ag as f,o as g,bz as j,c as y,ai as b,u as h,J as _,b as I,F as w,b0 as N,be as x,ah as F,n as U,aY as q,aW as E}from"./@vue-wTDZSr7R.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-Dk7pxPyP.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./department-api-IZzKtGZG.js";import"./position-api-Cwzz9KIn.js";const k=e=>(q("data-v-4a3df0fb"),e=e(),E(),e),C=k((()=>b("br",null,null,-1))),M=k((()=>b("p",{class:"hint"},"初始密码默认为：随机",-1))),D={class:"footer"},L=a({__name:"index",emits:["refresh","show-account"],setup(a,{expose:q,emit:E}){const k=p(),L=E,O=p(!1);function z(){R(),O.value=!1}const A=p([]);const B=p(),J={employeeId:void 0,actualName:void 0,departmentId:void 0,disabledFlag:0,leaveFlag:0,gender:l.MAN.value,loginName:void 0,phone:void 0,roleIdList:void 0,positionId:void 0,email:void 0};let P=c(e.cloneDeep(J));function R(){Object.assign(P,J),B.value.resetFields()}const S={actualName:[{required:!0,message:"姓名不能为空"},{max:30,message:"姓名不能大于30个字符",trigger:"blur"}],phone:[{required:!0,message:"手机号不能为空"},{pattern:m.phone,message:"请输入正确的手机号码",trigger:"blur"}],loginName:[{required:!0,message:"登录账号不能为空"},{max:30,message:"登录账号不能大于30个字符",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空"}],departmentId:[{required:!0,message:"部门不能为空"}],disabledFlag:[{required:!0,message:"状态不能为空"}],leaveFlag:[{required:!0,message:"在职状态不能为空"}],email:[{required:!0,message:"请输入邮箱"}]};async function W(e){let a=await function(e){return new Promise((a=>{e.validate().then((()=>{a(!0)})).catch((()=>{a(!1)}))}))}(B.value);a?(t.show(),P.employeeId?await async function(e){try{await o.updateEmployee(P);u.success("更新成功"),e?R():z(),L("refresh")}catch(a){r.captureError(a)}finally{t.hide()}}(e):await async function(e){try{let{data:a}=await o.addEmployee(P);u.success("添加成功"),L("show-account",P.loginName,a),e?R():z(),L("refresh")}catch(a){r.captureError(a)}finally{t.hide()}}(e)):u.error("参数验证错误，请仔细填写表单数据!")}return q({showDrawer:async function(a){Object.assign(P,J),a&&!e.isEmpty(a)&&Object.assign(P,a),O.value=!0,U((()=>{!async function(){let e=await s.queryAll();A.value=e.data}()}))}}),(e,a)=>{const l=v("a-alert"),t=v("a-input"),o=v("a-form-item"),r=v("a-select-option"),s=v("a-select"),m=v("a-form"),u=v("a-button"),p=v("a-drawer");return g(),f(p,{title:h(P).employeeId?"编辑":"添加",width:600,open:O.value,"body-style":{paddingBottom:"80px"},onClose:z,destroyOnClose:""},{default:j((()=>[y(l,{message:"超管需要直接在数据库表 t_employee修改哦",type:"error",closable:""}),C,y(m,{ref_key:"formRef",ref:B,model:h(P),rules:S,layout:"vertical"},{default:j((()=>[y(o,{label:"姓名",name:"actualName"},{default:j((()=>[y(t,{value:h(P).actualName,"onUpdate:value":a[0]||(a[0]=e=>h(P).actualName=e),valueModifiers:{trim:!0},placeholder:"请输入姓名"},null,8,["value"])])),_:1}),y(o,{label:"手机号",name:"phone"},{default:j((()=>[y(t,{value:h(P).phone,"onUpdate:value":a[1]||(a[1]=e=>h(P).phone=e),valueModifiers:{trim:!0},placeholder:"请输入手机号"},null,8,["value"])])),_:1}),y(o,{label:"部门",name:"departmentId"},{default:j((()=>[y(i,{ref_key:"departmentTreeSelect",ref:k,width:"100%",init:!1,value:h(P).departmentId,"onUpdate:value":a[2]||(a[2]=e=>h(P).departmentId=e)},null,8,["value"])])),_:1}),y(o,{label:"登录名",name:"loginName"},{default:j((()=>[y(t,{value:h(P).loginName,"onUpdate:value":a[3]||(a[3]=e=>h(P).loginName=e),valueModifiers:{trim:!0},placeholder:"请输入登录名"},null,8,["value"]),M])),_:1}),y(o,{label:"邮箱",name:"email"},{default:j((()=>[y(t,{value:h(P).email,"onUpdate:value":a[4]||(a[4]=e=>h(P).email=e),valueModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["value"])])),_:1}),y(o,{label:"性别",name:"gender"},{default:j((()=>[y(d,{style:{width:"100%"},value:h(P).gender,"onUpdate:value":a[5]||(a[5]=e=>h(P).gender=e),placeholder:"请选择性别","enum-name":"GENDER_ENUM"},null,8,["value"])])),_:1}),y(o,{label:"状态",name:"disabledFlag"},{default:j((()=>[y(s,{value:h(P).disabledFlag,"onUpdate:value":a[6]||(a[6]=e=>h(P).disabledFlag=e),placeholder:"请选择状态"},{default:j((()=>[y(r,{value:0},{default:j((()=>[_("启用")])),_:1}),y(r,{value:1},{default:j((()=>[_("禁用")])),_:1})])),_:1},8,["value"])])),_:1}),y(o,{label:"职务",name:"positionId"},{default:j((()=>[y(n,{value:h(P).positionId,"onUpdate:value":a[7]||(a[7]=e=>h(P).positionId=e),placeholder:"请选择职务"},null,8,["value"])])),_:1}),y(o,{label:"角色",name:"roleIdList"},{default:j((()=>[y(s,{mode:"multiple",value:h(P).roleIdList,"onUpdate:value":a[8]||(a[8]=e=>h(P).roleIdList=e),optionFilterProp:"title",placeholder:"请选择角色"},{default:j((()=>[(g(!0),I(w,null,N(A.value,(e=>(g(),f(r,{key:e.roleId,title:e.roleName},{default:j((()=>[_(x(e.roleName),1)])),_:2},1032,["title"])))),128))])),_:1},8,["value"])])),_:1})])),_:1},8,["model"]),b("div",D,[y(u,{style:{"margin-right":"8px"},onClick:z},{default:j((()=>[_("取消")])),_:1}),y(u,{type:"primary",style:{"margin-right":"8px"},onClick:a[9]||(a[9]=e=>W(!1))},{default:j((()=>[_("保存")])),_:1}),h(P).employeeId?F("",!0):(g(),f(u,{key:0,type:"primary",onClick:a[10]||(a[10]=e=>W(!0))},{default:j((()=>[_("保存并继续添加")])),_:1}))])])),_:1},8,["title","open"])}}},[["__scopeId","data-v-4a3df0fb"]]);export{L as default};
