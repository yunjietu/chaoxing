import{m as e}from"./ant-design-vue-qdrtx42b.js";import{d as t}from"./department-api-IZzKtGZG.js";import{_ as a}from"./index-D6sqxCCk.js";import r from"./index-BzPvxDWv.js";import{S as o,s}from"./index-SeYMZHv7.js";import{r as i,n,a as l,b2 as m,ag as d,o as p,bz as u,c as f,u as c,ah as j}from"./@vue-wTDZSr7R.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";const v={__name:"department-form-modal",emits:["refresh"],setup(v,{expose:h,emit:y}){h({showModal:function(e){b.value=!0,function(e){Object.assign(E,N),e&&Object.assign(E,e);b.value=!0}(e),n((()=>{const e=document.getElementsByClassName("ant-modal");e&&e.length>0&&Array.from(e).forEach((e=>{e.childNodes&&e.childNodes.length>0&&Array.from(e.childNodes).forEach((e=>{e.setAttribute&&e.setAttribute("aria-hidden","false")}))}))}))}});const g=y,b=i(!1);function I(){b.value=!1,Object.assign(E,N)}const w=i(),_=i(),N={id:void 0,managerId:void 0,departmentName:void 0,parentId:void 0,sort:0},x=i();let E=l({...N});const k={parentId:[{required:!0,message:"上级部门不能为空"}],departmentName:[{required:!0,message:"部门名称不能为空"},{max:50,message:"部门名称不能大于20个字符",trigger:"blur"}]};async function O(){try{await w.value.validate(),E.departmentId?async function(){o.show();try{if(E.parentId==E.departmentId)return void e.warning("上级菜单不能为自己");await t.updateDepartment(E),g("refresh"),I()}catch(a){s.captureError(a)}finally{o.hide()}}():async function(){o.show();try{await t.addDepartment(E),g("refresh"),I()}catch(e){s.captureError(e)}finally{o.hide()}}()}catch(a){e.error("参数验证错误，请仔细填写表单数据!")}}return(e,t)=>{const o=m("a-form-item"),s=m("a-input"),i=m("a-input-number"),n=m("a-form"),l=m("a-modal");return p(),d(l,{open:b.value,"onUpdate:open":t[4]||(t[4]=e=>b.value=e),title:c(E).departmentId?"编辑部门":"添加部门",onOk:O,destroyOnClose:""},{default:u((()=>[f(n,{ref_key:"formRef",ref:w,model:c(E),rules:k,layout:"vertical"},{default:u((()=>[0!=c(E).parentId?(p(),d(o,{key:0,label:"上级部门",name:"parentId"},{default:u((()=>[f(a,{ref_key:"departmentTreeSelect",ref:_,value:c(E).parentId,"onUpdate:value":t[0]||(t[0]=e=>c(E).parentId=e),defaultValueFlag:!1,width:"100%"},null,8,["value"])])),_:1})):j("",!0),f(o,{label:"部门名称",name:"departmentName"},{default:u((()=>[f(s,{value:c(E).departmentName,"onUpdate:value":t[1]||(t[1]=e=>c(E).departmentName=e),valueModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["value"])])),_:1}),f(o,{label:"部门负责人",name:"managerId"},{default:u((()=>[f(r,{ref_key:"employeeSelect",ref:x,placeholder:"请选择部门负责人",width:"100%",value:c(E).managerId,"onUpdate:value":t[2]||(t[2]=e=>c(E).managerId=e),leaveFlag:!1},null,8,["value"])])),_:1}),f(o,{label:"部门排序 （值越大越靠前！）",name:"sort"},{default:u((()=>[f(i,{style:{width:"100%"},value:c(E).sort,"onUpdate:value":t[3]||(t[3]=e=>c(E).sort=e),min:0,placeholder:"请输入部门排序"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["open","title"])}}};export{v as default};
