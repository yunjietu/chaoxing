import{_ as e,c as t,P as a,v as s,s as o}from"./index-SeYMZHv7.js";import{u as r}from"./ua-parser-js-D9VovvTw.js";import{r as i,a as l,b2 as n,b as p,o as d,c as u,ai as m,bz as c,J as f,ah as j,F as g,be as v,u as y}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";const h={class:"smart-query-table-page"},w=e({__name:"help-doc-view-record-list",props:{helpDocId:{type:[Number,String]}},setup(e,{expose:w}){const b=e;w({onSearch:q});const S=[{title:"用户名",dataIndex:"userName"},{title:"查看次数",dataIndex:"pageViewCount",with:100},{title:"首次查看设备",dataIndex:"firstIp"},{title:"首次查看时间",dataIndex:"createTime",with:120},{title:"最后一次查看设备",dataIndex:"lastIp"},{title:"最后一次查看时间",dataIndex:"updateTime",with:120}],I=i([]),z=i(0),x=i(!1),_={helpDocId:b.helpDocId,keywords:"",pageNum:1,pageSize:t},k=l({..._});function C(e){if(!e)return"";let t=r(e);return t.browser.name+"/"+t.os.name+"/"+(t.device.vendor?t.device.vendor+t.device.model:"")}async function D(){try{x.value=!0;const e=await s.queryViewRecord(k);for(const t of e.data.list)t.firstDevice=C(t.firstUserAgent),t.lastDevice=C(t.lastUserAgent);I.value=e.data.list,z.value=e.data.total}catch(e){o.captureError(e)}finally{x.value=!1}}function q(){k.pageNum=1,D()}function N(){Object.assign(k,_),D()}return(e,t)=>{const s=n("a-input"),o=n("a-form-item"),r=n("SearchOutlined"),i=n("a-button"),l=n("ReloadOutlined"),w=n("a-button-group"),b=n("a-row"),_=n("a-form"),C=n("a-table"),O=n("a-pagination");return d(),p("div",null,[u(_,{class:"smart-query-form"},{default:c((()=>[u(b,{class:"smart-query-form-row"},{default:c((()=>[u(o,{label:"关键字",class:"smart-query-form-item",style:{width:"280px"}},{default:c((()=>[u(s,{value:k.keywords,"onUpdate:value":t[0]||(t[0]=e=>k.keywords=e),placeholder:"姓名/IP/设备"},null,8,["value"])])),_:1}),u(o,{class:"smart-query-form-item smart-margin-left10"},{default:c((()=>[u(w,null,{default:c((()=>[u(i,{type:"primary",onClick:q},{icon:c((()=>[u(r)])),default:c((()=>[f(" 查询 ")])),_:1}),u(i,{onClick:N},{icon:c((()=>[u(l)])),default:c((()=>[f(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),u(C,{rowKey:"employeeId",columns:S,dataSource:I.value,pagination:!1,loading:x.value,size:"small",bordered:""},{bodyCell:c((({column:e,record:t,text:a})=>["firstIp"===e.dataIndex?(d(),p(g,{key:0},[f(v(a)+" ("+v(t.firstDevice)+") ",1)],64)):j("",!0),"lastIp"===e.dataIndex?(d(),p(g,{key:1},[f(v(a)+" ("+v(t.lastDevice)+") ",1)],64)):j("",!0)])),_:1},8,["dataSource","loading"]),m("div",h,[u(O,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:y(a),defaultPageSize:k.pageSize,current:k.pageNum,"onUpdate:current":t[1]||(t[1]=e=>k.pageNum=e),pageSize:k.pageSize,"onUpdate:pageSize":t[2]||(t[2]=e=>k.pageSize=e),total:z.value,onChange:D,onShowSizeChange:D,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])}}},[["__scopeId","data-v-76ab4b05"]]);export{w as default};
