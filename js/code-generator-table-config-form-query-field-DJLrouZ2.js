import{i as e,r as a,b2 as t,b as l,o,c as n,bz as s,J as u,ag as i,ah as m,u as r,F as d,b0 as p,y as c,be as y,ai as v,E as h,n as f}from"./@vue-wTDZSr7R.js";import{S as j}from"./sortablejs-CRp0PNdb.js";import b from"./index-DPBcXeae.js";import{o as w}from"./index-SeYMZHv7.js";import{b as N}from"./str-util-BDLBIRqu.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";const g={key:6,class:"smart-table-operate"},x={__name:"code-generator-table-config-form-query-field",setup(x,{expose:E}){e("tableInfo");const I=a([{title:"拖拽",dataIndex:"drag",width:60},{title:"查询类型",dataIndex:"queryTypeEnum",width:130},{title:"查询列",dataIndex:"columnNameList"},{title:"条件名称",dataIndex:"label",width:150},{title:"字段命名",dataIndex:"fieldName",width:150},{title:"宽度",dataIndex:"width",width:150},{title:"操作",dataIndex:"operate",width:60}]),C=a([]),L=a([]);let _=1;function k(){C.value.push({rowKey:"rowKey"+_,label:"",fieldName:"",queryTypeEnum:"",columnNameList:null,width:"200px"}),_++}return E({setData:function(e,a){_=1;let t=a&&a.queryFields?a.queryFields:[];for(let l=0;l<t.length;l++)t[l].rowKey="rowKey"+_,_++;C.value=t,L.value=e,f((()=>{!function(){let e=document.querySelector("#smartCodeQueryFieldsTable tbody");j.create(e,{animation:300,dragClass:"smart-ghost-class",ghostClass:"smart-ghost-class",chosenClass:"smart-ghost-class",handle:".handle",onEnd:({oldIndex:e,newIndex:a})=>{const t=C.value.splice(e-1,1)[0];C.value.splice(a-1,0,t)}})}()}))},getFieldsForm:function(){return C.value.map((e=>({label:e.label,width:e.width,fieldName:e.fieldName,queryTypeEnum:e.queryTypeEnum,columnNameList:e.columnNameList&&"string"==typeof e.columnNameList?[e.columnNameList]:e.columnNameList})))}}),(e,a)=>{const j=t("a-button"),x=t("a-row"),E=t("drag-outlined"),_=t("a-input"),q=t("a-select-option"),U=t("a-select"),T=t("a-table");return o(),l(d,null,[n(x,null,{default:s((()=>[n(j,{type:"primary",onClick:k},{default:s((()=>[u("添加查询条件")])),_:1})])),_:1}),n(T,{size:"small",bordered:"",id:"smartCodeQueryFieldsTable",class:"smart-margin-top10",dataSource:C.value,"row-class-name":"column-row",columns:I.value,rowKey:"rowKey",pagination:!1},{bodyCell:s((({record:e,index:a,column:t})=>["drag"===t.dataIndex?(o(),i(j,{key:0,type:"text",class:"handle",size:"small",style:{width:"100%","text-align":"left"}},{icon:s((()=>[n(E)])),_:1})):m("",!0),"label"===t.dataIndex?(o(),i(_,{key:1,value:e.label,"onUpdate:value":a=>e.label=a,placeholder:"关键字查询"},null,8,["value","onUpdate:value"])):m("",!0),"fieldName"===t.dataIndex?(o(),i(_,{key:2,value:e.fieldName,"onUpdate:value":a=>e.fieldName=a,placeholder:"keywords"},null,8,["value","onUpdate:value"])):m("",!0),"width"===t.dataIndex?(o(),i(_,{key:3,value:e.width,"onUpdate:value":a=>e.width=a,placeholder:"150px"},null,8,["value","onUpdate:value"])):m("",!0),"queryTypeEnum"===t.dataIndex?(o(),i(b,{key:4,onChange:a=>function(e,a){e===w.LIKE.value?a.columnNameList=[]:a.columnNameList=null}(a,e),enumName:"CODE_QUERY_FIELD_QUERY_TYPE_ENUM",value:e.queryTypeEnum,"onUpdate:value":a=>e.queryTypeEnum=a,width:"100%"},null,8,["onChange","value","onUpdate:value"])):m("",!0),"columnNameList"===t.dataIndex?(o(),i(U,{key:5,"show-search":"",mode:e.queryTypeEnum&&e.queryTypeEnum===r(w).LIKE.value?"multiple":"",value:e.columnNameList,"onUpdate:value":a=>e.columnNameList=a,onChange:a=>function(e){if(Array.isArray(e.columnNameList))return;let a=e.columnNameList,t=function(e,a){if(!e)return null;let t=e.filter((e=>e.columnName===a));return t&&t.length>0?t[0]:null}(L.value,a);e.fieldName=t&&t.columnName?N(t.columnName):"",e.label=t&&t.columnComment?N(t.columnComment):""}(e),style:{width:"100%"}},{default:s((()=>[(o(!0),l(d,null,p(L.value,(e=>(o(),i(q,{value:e.columnName,key:e.columnName},{default:s((()=>[u(y(e.columnName)+" ",1),c(v("span",null," （"+y(e.columnComment)+"） ",513),[[h,e.columnComment]])])),_:2},1032,["value"])))),128))])),_:2},1032,["mode","value","onUpdate:value","onChange"])):m("",!0),"operate"===t.dataIndex?(o(),l("div",g,[n(j,{type:"link",onClick:e=>function(e){const a=[...C.value];a.splice(e,1),C.value=[],f((()=>{C.value=a}))}(a),danger:""},{default:s((()=>[u("删除")])),_:2},1032,["onClick"])])):m("",!0)])),_:1},8,["dataSource","columns"])],64)}}};export{x as default};
