import{_ as e}from"./lodash-DG05lPuJ.js";import{d as t}from"./department-api-IZzKtGZG.js";import{d as a}from"./department-mitt-B-AWyKXu.js";import{_ as r}from"./index-SeYMZHv7.js";import{r as l,e as s,w as o,l as n,b2 as i,ag as d,o as p,bz as u,c,b as m,u as v,aR as h,ai as f,be as y}from"./@vue-wTDZSr7R.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./mitt-CNZ6avp8.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";const j={key:1,class:"no-data"},I=r({__name:"index",props:{checkable:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},height:Number,showMenu:{type:Boolean,default:!1}},setup(r,{expose:I}){const b=r,k=l(),g=l([]),x=l([]),w=l(new Map);async function E(){let a=(await t.queryAllDepartment()).data;g.value=a,x.value=K(a,0),a.forEach((e=>{w.value.set(e.departmentId,e)})),!e.isEmpty(x.value)&&x.value.length>0&&(k.value=x.value[0].departmentId),z(x.value[0].departmentId)}function K(e,t){let a=e.filter((e=>e.parentId===t))||[];return a.forEach((t=>{t.children=K(e,t.departmentId)})),function(e){for(let t=0;t<e.length;t++)0!==t?t!==e.length-1?(e[t].preId=e[t-1].departmentId,e[t].nextId=e[t+1].departmentId):(e[t].preId=e[t-1].departmentId,e[t].nextId=void 0):e[t].nextId=e.length>1?e[1].departmentId:void 0}(a),a}s((()=>{E()}));const _=l([]),D=l([]),N=l([]);l();const S=l([]);function z(e){_.value=[e],B(_.value)}function B(t){if(e.isEmpty(t))return N.value=[],void(S.value=[]);let a=t[0];S.value=g.value.filter((e=>e.parentId==a));let r=[];U(r,a,!0),N.value=r.map((e=>e.departmentName))}a.on("selectTree",z);const M=l("");function U(e,t,a){let r=w.value.get(t);r&&!e.some((e=>e.departmentId==t))&&(a?e.unshift(r):e.push(r),r.parentId&&0!=r.parentId&&U(e,r.parentId,a))}return o((()=>M.value),(()=>{!function(){if(!M.value)return void(x.value=K(g.value,0));let e=g.value.concat();if(!e)return;let t=e.filter((e=>e.departmentName.indexOf(M.value)>-1)),a=[];t.forEach((e=>{U(a,e.departmentId,!1)})),x.value=K(a,0)}()})),n((()=>{a.all.clear()})),I({queryDepartmentTree:E,selectedDepartmentChildren:S,breadcrumb:N,selectedKeys:_,checkedKeys:D,keywords:M}),(t,a)=>{const l=i("a-input"),s=i("a-row"),o=i("a-tree"),n=i("a-card");return p(),d(n,{class:"tree-container"},{default:u((()=>[c(s,{class:"smart-margin-bottom10"},{default:u((()=>[c(l,{value:M.value,"onUpdate:value":a[0]||(a[0]=e=>M.value=e),valueModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["value"])])),_:1}),v(e).isEmpty(x.value)?(p(),m("div",j,"暂无结果")):(p(),d(o,{key:0,selectedKeys:_.value,"onUpdate:selectedKeys":a[1]||(a[1]=e=>_.value=e),checkedKeys:D.value,"onUpdate:checkedKeys":a[2]||(a[2]=e=>D.value=e),class:"tree",treeData:x.value,fieldNames:{title:"departmentName",key:"departmentId",value:"departmentId"},style:h([{width:"100%","overflow-x":"auto"},[r.height?{height:`${r.height}px`,overflowY:"auto"}:""]]),checkable:b.checkable,checkStrictly:b.checkStrictly,selectable:!b.checkable,defaultExpandAll:!0,onSelect:B},{title:u((e=>[f("div",null,y(e.departmentName),1)])),_:1},8,["selectedKeys","checkedKeys","treeData","style","checkable","checkStrictly","selectable"]))])),_:1})}}},[["__scopeId","data-v-23ca6047"]]);export{I as default};
