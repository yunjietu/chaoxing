import{a}from"./account-api-CPPoY5oD.js";import{s as e,S as t}from"./index-SeYMZHv7.js";import{b as o}from"./ant-design-vue-qdrtx42b.js";import{r as l,a as s,n as r,b2 as n,ag as i,o as d,bz as u,c,u as p,J as m,ai as v}from"./@vue-wTDZSr7R.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-Dk7pxPyP.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const f={style:{display:"flex","align-items":"center",gap:"10px"}},h={__name:"account-operate-modal",emits:["refresh"],setup(h,{expose:j,emit:b}){j({showModal:function(o){Object.assign(E,I),o?async function(o){try{let e=(await a.detail(o)).data;Object.assign(E,e),x.value=!e.disabledFlag}catch(l){e.captureError(l)}finally{t.hide()}}(o):x.value=!0;g.value=!0,r((()=>{const a=document.getElementsByClassName("ant-modal");a&&a.length>0&&Array.from(a).forEach((a=>{a.childNodes&&a.childNodes.length>0&&Array.from(a.childNodes).forEach((a=>{a.setAttribute&&a.setAttribute("aria-hidden","false")}))}))}))}});const y=b,g=l(!1);function w(){g.value=!1}const _=l(),I={id:void 0,userId:void 0,name:void 0,account:void 0,password:void 0,school:void 0,major:void 0,contractEnterprise:void 0,internshipStatus:void 0,disabledFlag:!1};let E=s({...I});const k={account:[{required:!0,message:"请输入账号"}],password:[{required:!0,message:"请输入密码"}]};function U(){_.value.validate().then((async()=>{t.show();try{E.id?await a.update(E):await a.create(E),o.success((E.id?"修改":"添加")+"成功"),w(),y("refresh")}catch(l){e.captureError(l)}finally{t.hide()}})).catch((a=>{}))}const x=l(!0);function S(a){E.disabledFlag=!a}const C=l(!1);async function z(){if(E.account&&E.password){C.value=!0;try{const e=await a.getZhixiaoUserInfo({account:E.account,password:E.password});if(e.data){const{uid:t,token:l,deviceId:s}=e.data,r=await a.getUserInfoByToken({uid:t,token:l,deviceId:s});r.data&&(E.userId=r.data.uid,E.name=r.data.uname,E.school=r.data.schoolname,E.major=r.data.major,o.success("获取个人信息成功"));const n=await a.getInternshipInfo({uid:t,token:l,deviceId:s});n.data&&(E.contractEnterprise=n.data.contractEnterprise,E.internshipStatus=n.data.internshipStatus,o.success("实习信息获取成功"))}}catch(t){o.error(t?.data?.msg||"获取信息失败"),e.captureError(t)}finally{C.value=!1}}else o.warning("请先输入账号和密码")}return(a,e)=>{const t=n("a-input"),o=n("a-form-item"),l=n("a-input-password"),s=n("a-select-option"),r=n("a-select"),h=n("a-switch"),j=n("a-button"),b=n("a-form"),y=n("a-modal");return d(),i(y,{open:g.value,title:p(E).id?"编辑":"添加",width:700,forceRender:"","ok-text":"确认","cancel-text":"取消",onOk:U,onCancel:w},{default:u((()=>[c(b,{ref_key:"formRef",ref:_,model:p(E),rules:k,"label-col":{span:5},"wrapper-col":{span:18}},{default:u((()=>[c(o,{label:"用户ID",name:"userId"},{default:u((()=>[c(t,{value:p(E).userId,"onUpdate:value":e[0]||(e[0]=a=>p(E).userId=a),placeholder:"请输入用户ID"},null,8,["value"])])),_:1}),c(o,{label:"姓名",name:"name"},{default:u((()=>[c(t,{value:p(E).name,"onUpdate:value":e[1]||(e[1]=a=>p(E).name=a),placeholder:"请输入姓名"},null,8,["value"])])),_:1}),c(o,{label:"账号",name:"account"},{default:u((()=>[c(t,{value:p(E).account,"onUpdate:value":e[2]||(e[2]=a=>p(E).account=a),placeholder:"请输入账号"},null,8,["value"])])),_:1}),c(o,{label:"密码",name:"password"},{default:u((()=>[c(l,{value:p(E).password,"onUpdate:value":e[3]||(e[3]=a=>p(E).password=a),placeholder:"请输入密码"},null,8,["value"])])),_:1}),c(o,{label:"学校",name:"school"},{default:u((()=>[c(t,{value:p(E).school,"onUpdate:value":e[4]||(e[4]=a=>p(E).school=a),placeholder:"请输入学校名称"},null,8,["value"])])),_:1}),c(o,{label:"专业",name:"major"},{default:u((()=>[c(t,{value:p(E).major,"onUpdate:value":e[5]||(e[5]=a=>p(E).major=a),placeholder:"请输入专业名称"},null,8,["value"])])),_:1}),c(o,{label:"签约企业",name:"contractEnterprise"},{default:u((()=>[c(t,{value:p(E).contractEnterprise,"onUpdate:value":e[6]||(e[6]=a=>p(E).contractEnterprise=a),placeholder:"请输入签约企业名称"},null,8,["value"])])),_:1}),c(o,{label:"实习状态",name:"internshipStatus"},{default:u((()=>[c(r,{value:p(E).internshipStatus,"onUpdate:value":e[7]||(e[7]=a=>p(E).internshipStatus=a),placeholder:"请选择实习状态",style:{width:"100%"}},{default:u((()=>[c(s,{value:1},{default:u((()=>[m("正在实习")])),_:1}),c(s,{value:2},{default:u((()=>[m("实习结束")])),_:1}),c(s,{value:3},{default:u((()=>[m("签约成功")])),_:1}),c(s,{value:4},{default:u((()=>[m("未开始")])),_:1})])),_:1},8,["value"])])),_:1}),c(o,{label:"启用状态",name:"disabledFlag"},{default:u((()=>[v("div",f,[c(h,{checked:x.value,"onUpdate:checked":e[8]||(e[8]=a=>x.value=a),onChange:S},null,8,["checked"]),c(j,{type:"primary",size:"small",onClick:z,loading:C.value},{default:u((()=>[m(" 获取信息 ")])),_:1},8,["loading"])])])),_:1})])),_:1},8,["model"])])),_:1},8,["open","title"])}}};export{h as default};
