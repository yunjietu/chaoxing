const __vite__fileDeps=["js/index-DPBcXeae.js","js/@vue-wTDZSr7R.js","js/goods-form-modal-DIMO7ZkW.js","js/category-api-CAxoDcQy.js","js/index-SeYMZHv7.js","js/ant-design-vue-qdrtx42b.js","js/@babel-rSvM8Ko2.js","js/@ant-design-BpN5YQ3K.js","js/vue-LkNShnlx.js","js/@ctrl-BZ4iwDfm.js","js/resize-observer-polyfill-OVnto9HH.js","js/@emotion-BUNCmyKw.js","js/stylis-cmx5w8r8.js","js/vue-types-Ci_fOQyt.js","js/dom-align-CCb293uS.js","js/lodash-es-DiERF9Dp.js","js/dayjs-Dk7pxPyP.js","js/async-validator-BTKOuuO-.js","js/throttle-debounce-w9OM8Bxz.js","css/ant-design-vue-Cm_1FYRq.css","js/lodash-DG05lPuJ.js","js/vue3-json-viewer-BcgvkQJY.js","css/vue3-json-viewer-DURLcZvU.css","js/vue-i18n-DZLdcVEL.js","js/@intlify-D9VlDxbJ.js","js/pinia-BY_IhmGU.js","js/axios-BlN9Xwzv.js","js/crypto-js-DUpU9tZe.js","js/sm-crypto-CNoQwlJF.js","js/jsbn-aJNYh3Pg.js","js/nprogress-Buvl-64T.js","css/nprogress-BUMXTAWU.css","js/vue-router-BJIyZwNj.js","js/mitt-CNZ6avp8.js","css/index-BCYnl9N0.css","js/index-BzPvxDWv.js","js/index-CFB2wdYv.js","js/enterprise-api-CP888bMY.js","js/index-Br4j2Q_F.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as e,a as t,b as a,g as l}from"./goods-form-modal-DIMO7ZkW.js";import{_ as o,a as n,u as s,C as i,D as r,P as u,s as d,S as c}from"./index-SeYMZHv7.js";import{_ as p}from"./index-C3kHkCVg.js";import{T as m}from"./table-id-const-CfofKxZg.js";import f from"./index-DPBcXeae.js";import{_ as v}from"./lodash-DG05lPuJ.js";import{d as y}from"./dayjs-Dk7pxPyP.js";import{d as g}from"./default-time-ranges-C0dlfVG_.js";import{w as h,bn as _,r as b,e as O,b2 as x,b as k,o as w,ai as S,b1 as j,J as C,be as I,ah as E,F as z,ag as T,u as D,c as U,bz as L,b3 as q,aq as A,m as N,a as P,z as G,y as F}from"./@vue-wTDZSr7R.js";import{M as R,b as V}from"./ant-design-vue-qdrtx42b.js";import"./category-api-CAxoDcQy.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const M={class:"container"},K={class:"table-title"},H={class:"filter",style:{"max-width":"300px","min-height":"40px"}},$={key:4,class:"smart-table-operate"},J={key:1,class:"error-component"},W=o({__name:"index",props:{value:{type:[Number,String,Array,Object]},column:{type:Object,default:()=>{}}},emits:["change","update:value"],setup(e,{emit:t}){const a=e,l={"enum-select":A((()=>n((()=>import("./index-DPBcXeae.js")),__vite__mapDeps([0,1])))),"dict-select":A((()=>n((()=>import("./goods-form-modal-DIMO7ZkW.js").then((e=>e.c))),__vite__mapDeps([2,3,4,1,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,0])))),"employee-select":A((()=>n((()=>import("./index-BzPvxDWv.js")),__vite__mapDeps([35,4,1,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34])))),"enterprise-select":A((()=>n((()=>import("./index-CFB2wdYv.js")),__vite__mapDeps([36,37,4,1,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34])))),"boolean-select":A((()=>n((()=>import("./index-Br4j2Q_F.js")),__vite__mapDeps([38,20,7,1,8,9])))),"category-tree":A((()=>n((()=>import("./goods-form-modal-DIMO7ZkW.js").then((e=>e.i))),__vite__mapDeps([2,3,4,1,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,0]))))},o=Object.keys(l);h((()=>a.value),(()=>{!a.column.filterOptions||"date-range"!==a.column.filterOptions.type&&"datetime-range"!==a.column.filterOptions.type?r.value=a.value:v.isEmpty(a.value)||2!==a.value.length||v.isEmpty(a.value[0])||v.isEmpty(a.value[1])?i.value=[]:i.value=[y(a.value[0]),y(a.value[1])]})),_();const s=t,i=b([]),r=b(void 0);function u(e,t){s("change",{type:a.column.filterOptions.type,key:a.column.filterOptions.key||a.column.dataIndex,value:[t[0],t[1]],search:!0})}function d(e){let t=!0;"no-search"===e&&(t=!1),s("update:value",r.value),s("change",{type:a.column.filterOptions.type,key:a.column.filterOptions.key||a.column.dataIndex,value:r.value,search:t})}function c(){s("change",{search:!0})}return O((()=>{!a.column.filterOptions||"date-range"!==a.column.filterOptions.type&&"datetime-range"!==a.column.filterOptions.type?r.value=a.value:v.isEmpty(a.value)||2!==a.value.length||v.isEmpty(a.value[0])||v.isEmpty(a.value[1])?i.value=[]:i.value=[y(a.value[0]),y(a.value[1])]})),(t,a)=>{const n=x("a-input-search"),s=x("a-range-picker"),p=x("a-button");return w(),k("div",M,[S("div",K,[j(t.$slots,"title",{},(()=>[C(I(e.column.title),1)]),!0)]),S("div",H,[j(t.$slots,"default",{},(()=>{return[e.column.filterOptions?(w(),k(z,{key:0},["input"===e.column.filterOptions.type?(w(),T(n,{key:0,onChange:a[0]||(a[0]=e=>d("no-search")),value:r.value,"onUpdate:value":a[1]||(a[1]=e=>r.value=e),allowClear:"",placeholder:e.column.placeholder||e.column.title,onSearch:d},null,8,["value","placeholder"])):"date-range"===e.column.filterOptions.type?(w(),T(s,{key:1,value:i.value,"onUpdate:value":a[2]||(a[2]=e=>i.value=e),ranges:e.column.filterOptions.ranges?D(g):[],style:{width:"100%"},onChange:u},null,8,["value","ranges"])):"datetime-range"===e.column.filterOptions.type?(w(),T(s,{key:2,"show-time":"",value:i.value,"onUpdate:value":a[3]||(a[3]=e=>i.value=e),ranges:e.column.filterOptions.ranges?D(g):[],style:{width:"100%"},onChange:u},null,8,["value","ranges"])):"month"===e.column.filterOptions.type?(w(),T(s,{key:3,value:i.value,"onUpdate:value":a[4]||(a[4]=e=>i.value=e),picker:"month",onChange:u},null,8,["value"])):"submit"===e.column.filterOptions.type?(w(),k("div",$,[U(p,{type:e.column.filterOptions.btnType,onClick:c},{default:L((()=>[C("查询")])),_:1},8,["type"])])):(w(),k(z,{key:5},[D(o).includes(e.column.filterOptions.type)?(w(),T(q((t=e.column.filterOptions.type,l[t])),{key:0,width:"100%",value:r.value,"onUpdate:value":a[5]||(a[5]=e=>r.value=e),multiple:e.column.filterOptions.multiple,dictCode:e.column.filterOptions.dictCode,enumName:e.column.filterOptions.enumName,systemConfigKey:e.column.filterOptions.systemConfigKey,placeholder:e.column.placeholder,leaveFlag:e.column.filterOptions.leaveFlag,categoryType:e.column.filterOptions.categoryType,onChange:d},null,40,["value","multiple","dictCode","enumName","systemConfigKey","placeholder","leaveFlag","categoryType"])):(w(),k("div",J,"未定义的组件类型"))],64))],64)):E("",!0)];var t}),!0)])])}}},[["__scopeId","data-v-67c70b62"]]),B={__name:"index",props:{dictCode:String,dataValue:[String,Number]},setup(e){const t=e,a=N((()=>s().getDataLabels(t.dictCode,t.dataValue)));return(e,t)=>(w(),k("span",null,I(a.value),1))}},Q={class:"smart-table-operate-block"},Z={class:"smart-table-setting-block"},X={key:2},Y={key:3},ee={key:4},te={key:5,class:"smart-table-operate"},ae={class:"smart-query-table-page"},le={style:{"text-align":"center",width:"400px",margin:"0 auto"}},oe=S("br",null,null,-1),ne=S("br",null,null,-1),se=S("br",null,null,-1),ie={__name:"goods-list",setup(o){const n=b([{title:"商品分类",dataIndex:"categoryName",resizable:!0,filterOptions:{type:"category-tree",key:"categoryId",categoryType:i.GOODS.value},width:150},{title:"商品名称",dataIndex:"goodsName",resizable:!0,filterOptions:{type:"input",key:"searchWord"},width:150},{title:"商品状态",dataIndex:"goodsStatus",resizable:!0,filterOptions:{type:"enum-select",enumName:"GOODS_STATUS_ENUM"},width:150},{title:"产地",dataIndex:"place",resizable:!0,filterOptions:{type:"dict-select",dictCode:r.GOODS_PLACE||"GOODS_PLACE"},width:150},{title:"价格",dataIndex:"price",resizable:!0,sorter:!0,width:100},{title:"状态",dataIndex:"shelvesFlag",resizable:!0,sorter:!0,width:80},{title:"备注",dataIndex:"remark",ellipsis:!0,resizable:!0,width:150},{title:"创建时间",dataIndex:"createTime",resizable:!0,width:150},{title:"操作",dataIndex:"action",resizable:!0,fixed:"right",width:100}]),s={categoryId:void 0,searchWord:"",goodsStatus:void 0,place:void 0,shelvesFlag:void 0,goodsType:void 0,pageNum:1,pageSize:10,sortItemList:[]},y=P(v.cloneDeep(s)),g=b(!1),h=b([]),_=b(0);function j(e,t){n.value.forEach((a=>{a.dataIndex===t.dataIndex&&(a.width=Math.floor(e),a.dragAndDropFlag=!0)}))}function q(){let e=y.pageSize;Object.assign(y,v.cloneDeep(s)),y.pageSize=e,N()}function A(){y.pageNum=1,N()}async function N(){g.value=!0;try{let e=await l.queryGoodsList(y);h.value=e.data.list,_.value=e.data.total}catch(e){d.captureError(e)}finally{g.value=!1}}O(N);const M=b();function K(e){M.value.showDrawer(e)}function H(e){R.confirm({title:"提示",content:"确定要删除【"+e.goodsName+"】吗?",okText:"删除",okType:"danger",onOk(){!async function(e){try{c.show(),await l.deleteGoods(e.goodsId),V.success("删除成功"),N()}catch(t){d.captureError(t)}finally{c.hide()}}(e)},cancelText:"取消",onCancel(){}})}const $=b([]);function J(e){$.value=e}function ie(){R.confirm({title:"提示",content:"确定要删除选中商品吗?",okText:"删除",okType:"danger",onOk(){!async function(){try{c.show(),await l.batchDelete($.value),V.success("删除成功"),N()}catch(e){d.captureError(e)}finally{c.hide()}}()},cancelText:"取消",onCancel(){}})}const re=b(!1),ue=b([]);function de(){ue.value=[],re.value=!0}function ce(){re.value=!1}function pe(e){const t=ue.value.indexOf(e),a=ue.value.slice();a.splice(t,1),ue.value=a}function me(e){return ue.value=[...ue.value||[],e],!1}function fe(){window.open("https://smartadmin.vip/cdn/%E5%95%86%E5%93%81%E6%A8%A1%E6%9D%BF.xls")}async function ve(){const e=new FormData;ue.value.forEach((t=>{e.append("file",t.originFileObj)})),c.show();try{let t=await l.importGoods(e);V.success(t.msg)}catch(t){d.captureError(t)}finally{c.hide()}}async function ye(){await l.exportGoods()}function ge(e,t,a,{action:l}){if("sort"===l){const{order:e,field:t}=a;let l=t.replace(/([A-Z])/g,"_$1").toLowerCase(),o=y.sortItemList.findIndex((e=>e.column===l));if(-1!==o&&y.sortItemList.splice(o,1),e){let t="ascend"!==e;y.sortItemList.push({column:l,isAsc:t})}N()}}const he=b(0);function _e(){let e=document.querySelector(".ant-form"),t=document.querySelector(".smart-table-btn-block"),a=document.querySelector(".ant-table-cell"),l=document.querySelector(".smart-query-table-page"),o=document.querySelector(".admin-content");setTimeout((()=>{let n=e.offsetHeight+10+24+t.offsetHeight+15+a.offsetHeight+l.offsetHeight+20;he.value=o.offsetHeight-n}),100)}return O((()=>{_e()})),window.addEventListener("resize",v.throttle((()=>{_e()}),1e3)),(l,o)=>{const s=x("a-form-item"),d=x("a-input"),c=x("a-radio-button"),v=x("a-radio-group"),g=x("SearchOutlined"),b=x("a-button"),O=x("ReloadOutlined"),P=x("a-button-group"),R=x("a-row"),V=x("a-form"),_e=x("PlusOutlined"),be=x("DeleteOutlined"),Oe=x("ImportOutlined"),xe=x("ExportOutlined"),ke=x("a-table"),we=x("a-pagination"),Se=x("download-outlined"),je=x("upload-outlined"),Ce=x("a-upload"),Ie=x("a-modal"),Ee=x("a-card"),ze=G("privilege");return w(),k(z,null,[U(V,{class:"smart-query-form"},{default:L((()=>[F((w(),T(R,{class:"smart-query-form-row"},{default:L((()=>[U(s,{label:"商品分类",class:"smart-query-form-item"},{default:L((()=>[U(e,{width:"150px",value:y.categoryId,"onUpdate:value":o[0]||(o[0]=e=>y.categoryId=e),placeholder:"请选择商品分类",categoryType:D(i).GOODS.value},null,8,["value","categoryType"])])),_:1}),U(s,{label:"商品名称",class:"smart-query-form-item"},{default:L((()=>[U(d,{style:{width:"200px"},value:y.searchWord,"onUpdate:value":o[1]||(o[1]=e=>y.searchWord=e),placeholder:"商品名称"},null,8,["value"])])),_:1}),U(s,{label:"产地",name:"place",class:"smart-query-form-item"},{default:L((()=>[U(t,{"dict-code":D(r).GOODS_PLACE,value:y.place,"onUpdate:value":o[2]||(o[2]=e=>y.place=e),width:"120px"},null,8,["dict-code","value"])])),_:1}),U(s,{label:"商品状态",name:"goodsStatus",class:"smart-query-form-item"},{default:L((()=>[U(f,{"enum-name":"GOODS_STATUS_ENUM",value:y.goodsStatus,"onUpdate:value":o[3]||(o[3]=e=>y.goodsStatus=e),width:"160px"},null,8,["value"])])),_:1}),U(s,{label:"快速筛选",class:"smart-query-form-item"},{default:L((()=>[U(v,{value:y.shelvesFlag,"onUpdate:value":o[4]||(o[4]=e=>y.shelvesFlag=e),onChange:A},{default:L((()=>[U(c,{value:void 0},{default:L((()=>[C("全部")])),_:1}),U(c,{value:"true"},{default:L((()=>[C("上架")])),_:1}),U(c,{value:"false"},{default:L((()=>[C("下架")])),_:1})])),_:1},8,["value"])])),_:1}),U(s,{class:"smart-query-form-item"},{default:L((()=>[U(P,null,{default:L((()=>[F((w(),T(b,{type:"primary",onClick:A},{icon:L((()=>[U(g)])),default:L((()=>[C(" 查询 ")])),_:1})),[[ze,"goods:query"]]),F((w(),T(b,{onClick:q},{icon:L((()=>[U(O)])),default:L((()=>[C(" 重置 ")])),_:1})),[[ze,"goods:query"]])])),_:1})])),_:1})])),_:1})),[[ze,"goods:query"]])])),_:1}),U(Ee,{size:"small",bordered:!1,hoverable:!0},{default:L((()=>[U(R,{class:"smart-table-btn-block"},{default:L((()=>[S("div",Q,[F((w(),T(b,{onClick:K,type:"primary"},{icon:L((()=>[U(_e)])),default:L((()=>[C(" 新建 ")])),_:1})),[[ze,"goods:add"]]),F((w(),T(b,{onClick:ie,danger:"",disabled:0===$.value.length},{icon:L((()=>[U(be)])),default:L((()=>[C(" 批量删除 ")])),_:1},8,["disabled"])),[[ze,"goods:batchDelete"]]),F((w(),T(b,{onClick:de,type:"primary"},{icon:L((()=>[U(Oe)])),default:L((()=>[C(" 导入 ")])),_:1})),[[ze,"goods:importGoods"]]),F((w(),T(b,{onClick:ye,type:"primary"},{icon:L((()=>[U(xe)])),default:L((()=>[C(" 导出 ")])),_:1})),[[ze,"goods:exportGoods"]])]),S("div",Z,[U(p,{modelValue:n.value,"onUpdate:modelValue":o[5]||(o[5]=e=>n.value=e),tableId:D(m).BUSINESS.ERP.GOODS,refresh:N},null,8,["modelValue","tableId"])])])),_:1}),U(ke,{size:"small",dataSource:h.value,columns:n.value,rowKey:"goodsId",scroll:{x:1e3,y:he.value},bordered:"",pagination:!1,showSorterTooltip:!1,"row-selection":{selectedRowKeys:$.value,onChange:J},onChange:ge,onResizeColumn:j},{headerCell:L((({column:e})=>[U(W,{value:y[e.filterOptions?.key||e.dataIndex],"onUpdate:value":t=>y[e.filterOptions?.key||e.dataIndex]=t,column:e,onChange:N},null,8,["value","onUpdate:value","column"])])),bodyCell:L((({text:e,record:t,column:a})=>["goodsName"===a.dataIndex?(w(),k(z,{key:0},[C(I(e),1)],64)):E("",!0),"place"===a.dataIndex?(w(),T(B,{key:1,"dict-code":D(r).GOODS_PLACE,"data-value":e},null,8,["dict-code","data-value"])):E("",!0),"remark"===a.dataIndex?(w(),k("span",X,I(e||""),1)):E("",!0),"goodsStatus"===a.dataIndex?(w(),k("span",Y,I(l.$smartEnumPlugin.getDescByValue("GOODS_STATUS_ENUM",e)),1)):E("",!0),"shelvesFlag"===a.dataIndex?(w(),k("span",ee,I(e?"上架":"下架"),1)):E("",!0),"action"===a.dataIndex?(w(),k("div",te,[F((w(),T(b,{onClick:e=>K(t),type:"link"},{default:L((()=>[C("编辑")])),_:2},1032,["onClick"])),[[ze,"goods:update"]]),F((w(),T(b,{onClick:e=>H(t),danger:"",type:"link"},{default:L((()=>[C("删除")])),_:2},1032,["onClick"])),[[ze,"goods:delete"]])])):E("",!0)])),_:1},8,["dataSource","columns","scroll","row-selection"]),S("div",ae,[U(we,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:D(u),defaultPageSize:y.pageSize,current:y.pageNum,"onUpdate:current":o[6]||(o[6]=e=>y.pageNum=e),pageSize:y.pageSize,"onUpdate:pageSize":o[7]||(o[7]=e=>y.pageSize=e),total:_.value,onChange:N,onShowSizeChange:N,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),U(a,{ref_key:"formModal",ref:M,onReloadList:N},null,512),U(Ie,{open:re.value,"onUpdate:open":o[9]||(o[9]=e=>re.value=e),title:"导入",onOnCancel:ce,onOk:ce},{default:L((()=>[S("div",le,[U(b,{onClick:fe},{default:L((()=>[U(Se),C("第一步：下载模板")])),_:1}),oe,ne,U(Ce,{fileList:ue.value,"onUpdate:fileList":o[8]||(o[8]=e=>ue.value=e),name:"file",multiple:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",accept:".xls,.xlsx","before-upload":me,onRemove:pe},{default:L((()=>[U(b,null,{default:L((()=>[U(je),C(" 第二步：选择文件 ")])),_:1})])),_:1},8,["fileList"]),se,U(b,{onClick:ve},{default:L((()=>[U(Oe),C(" 第三步：开始导入 ")])),_:1})])])),_:1},8,["open"])])),_:1})],64)}}};export{ie as default};
