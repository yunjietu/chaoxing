import{C as e,s as a,S as t}from"./index-SeYMZHv7.js";import o from"./category-form-modal-BXvm1r5v.js";import{c as r}from"./category-api-CAxoDcQy.js";import{M as s,b as i}from"./ant-design-vue-qdrtx42b.js";import{m as l,r as n,a as c,e as p,b2 as d,z as m,ag as y,o as u,bz as g,c as f,ai as j,y as v,J as b,b as k,ah as x}from"./@vue-wTDZSr7R.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-Dk7pxPyP.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const h={class:"smart-table-operate-block"},C=j("div",{class:"smart-table-setting-block"},null,-1),w={key:0,class:"smart-table-operate"},T={__name:"category-tree-table",props:{categoryType:Number,privilegePrefix:{type:String,default:""}},setup(T,{expose:_}){const I=[{categoryType:e.GOODS.value,columnName:"商品分类"},{categoryType:e.DEMO.value,columnName:"演示分类"}],z=l((()=>{let e=I.find((e=>e.categoryType===P.categoryType));return e?e.columnName:""})),P=T,E=n(!1),N=n([]),O=c([{title:z,dataIndex:"categoryName"},{title:"操作",dataIndex:"action",width:200}]);async function S(){try{E.value=!0;let e={categoryType:P.categoryType},a=await r.queryCategoryTree(e);N.value=a.data}catch(e){a.captureError(e)}finally{E.value=!1}}const M=n([]);function $(e){S(),e&&M.value.push(e)}function D(e){M.value=e}p(S),_({queryList:S});const q=n();function L(e,a){q.value.showModal(P.categoryType,e,a)}function R(e){s.confirm({title:"提示",content:"确定要删除当前分类吗?",okText:"确定",okType:"danger",async onOk(){!async function(e){try{t.show(),await r.deleteCategoryById(e),i.success("删除成功"),S()}catch(o){a.captureError(o)}finally{t.hide()}}(e)},cancelText:"取消",onCancel(){}})}return(e,a)=>{const t=d("PlusOutlined"),r=d("a-button"),s=d("a-row"),i=d("a-table"),l=d("a-card"),n=m("privilege");return u(),y(l,{size:"small",bordered:!1,hoverable:!0},{default:g((()=>[f(s,{class:"smart-table-btn-block"},{default:g((()=>[j("div",h,[v((u(),y(r,{onClick:a[0]||(a[0]=e=>L()),type:"primary"},{icon:g((()=>[f(t)])),default:g((()=>[b(" 新建 ")])),_:1})),[[n,`${T.privilegePrefix}category:add`]])]),C])),_:1}),f(i,{scroll:{x:1e3},size:"small",dataSource:N.value,columns:O,rowKey:"categoryId",bordered:"",pagination:!1,onExpandedRowsChange:D,"expanded-row-keys":M.value},{bodyCell:g((({record:e,column:a})=>["action"===a.dataIndex?(u(),k("div",w,[v((u(),y(r,{onClick:a=>L(e.categoryId),type:"link"},{default:g((()=>[b("增加子分类")])),_:2},1032,["onClick"])),[[n,`${T.privilegePrefix}category:addChild`]]),v((u(),y(r,{onClick:a=>L(void 0,e),type:"link"},{default:g((()=>[b("编辑")])),_:2},1032,["onClick"])),[[n,`${T.privilegePrefix}category:update`]]),v((u(),y(r,{onClick:a=>R(e.categoryId),danger:"",type:"link"},{default:g((()=>[b("删除")])),_:2},1032,["onClick"])),[[n,`${T.privilegePrefix}category:delete`]])])):x("",!0)])),_:1},8,["dataSource","columns","expanded-row-keys"]),f(o,{ref_key:"formModal",ref:q,onReloadList:$},null,512)])),_:1})}}};export{T as default};
