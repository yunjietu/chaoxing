import{_ as e}from"./lodash-DG05lPuJ.js";import{a}from"./vue-router-BJIyZwNj.js";import t from"./enterprise-bank-list-DTkBnvOv.js";import r from"./enterprise-employee-list-BY0mnAqW.js";import l from"./enterprise-invoice-list-XfZgIJr2.js";import i from"./enterprise-operate-modal-ChJNaCDe.js";import{e as s}from"./enterprise-api-CP888bMY.js";import{p as o,_ as n,c as d,P as u,s as p,S as m}from"./index-SeYMZHv7.js";import{c}from"./diff-BE8ux7Aj.js";import{h as f}from"./diff2html-Cjc1Nsmf.js";import{u as v}from"./ua-parser-js-D9VovvTw.js";import{b2 as y,ag as j,o as b,bz as _,b as g,F as h,b0 as w,ai as k,ah as N,be as S,a as I,r as z,w as L,c as O,J as E,u as q,n as x,e as C,m as T}from"./@vue-wTDZSr7R.js";import{_ as A}from"./index-CBCNaAiZ.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./enterprise-bank-operate-modal-CEhe7NJa.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./index-C3kHkCVg.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */import"./table-id-const-CfofKxZg.js";import"./index-XYBhx42c.js";import"./index-D6sqxCCk.js";import"./department-api-IZzKtGZG.js";import"./enterprise-invoice-operate-modal-1KnO1rNS.js";import"./regular-const-Uc_6Drqv.js";import"./index-DPBcXeae.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./mitt-CNZ6avp8.js";import"./hogan.js-C2UNKCU2.js";
/*
 * 数据变动
 *
 * @Author:    卓大
 * @Date:      2022-09-03 21:51:54
 * @Wechat:    zhuda1024
 * @Email:     lab1024@163.com
 * @Copyright  1024创新实验室 （ https://1024lab.net ），Since 2012
 */const D=e=>o("/support/dataTracer/query",e),R={class:"trace-div"},U=["innerHTML"],$=["onClick"],M={class:"ip-font"},P=n({__name:"data-tracer-timeline",props:{tableData:{type:Array}},emits:["showDetail"],setup(e,{emit:a}){const t=a;return(a,r)=>{const l=y("a-timeline-item"),i=y("a-timeline");return b(),j(i,null,{default:_((()=>[(b(!0),g(h,null,w(e.tableData,(e=>(b(),j(l,{key:e.dataTracerId},{default:_((()=>[k("div",R,[k("div",null,[k("div",{class:"operate-content",innerHTML:e.content},null,8,U),e.diffOld||e.diffNew?(b(),g("a",{key:0,href:"javascript:void(0)",onClick:a=>function(e){t("showDetail",e)}(e)},"（查看修改）",8,$)):N("",!0)]),k("div",M,S(e.createTime)+" | "+S(e.userName)+" | "+S(e.ipRegion)+" | "+S(e.ip)+" | "+S(e.browser)+" | "+S(e.os),1)])])),_:2},1024)))),128))])),_:1})}}},[["__scopeId","data-v-76258708"]]),H=["innerHTML"],F={__name:"index",props:{dataId:{type:Number},type:{type:Number}},setup(e){let a=e;const t={pageNum:1,pageSize:d,searchCount:!0,keywords:void 0},r=I({...t}),l=z(!1),i=z([]),s=z(0);function o(){Object.assign(r,t),n()}function n(){r.pageNum=1,m()}async function m(){try{l.value=!0;let e=await D(Object.assign({},r,{dataId:a.dataId,type:a.type}));for(const a of e.data.list){if(!a.userAgent)continue;let e=v(a.userAgent);a.browser=e.browser.name,a.os=e.os.name,a.device=e.device.vendor?e.device.vendor+e.device.model:""}const t=e.data.list;s.value=e.data.total,i.value=t}catch(e){p.captureError(e)}finally{l.value=!1}}L((()=>a.dataId),(e=>{e&&(r.dataId=e,n())}),{immediate:!0});const j=z(!1);let w=z("");function N(e){j.value=!0;let a=e.diffOld.replaceAll("<br/>","\r\n"),t=e.diffNew.replaceAll("<br/>","\r\n");let r=c(...["",a,t,"变更前","变更后"]),l=f(r,{drawFileList:!1,matching:"words",diffMaxChanges:1e3,outputFormat:"side-by-side"});w.value=l,x((()=>{let e=document.querySelectorAll(".d2h-file-side-diff");if(e.length>0){let a=e[0],t=e[1];a.addEventListener("scroll",(function(e){a.scrollLeft!==t.scrollLeft&&(t.scrollLeft=a.scrollLeft)})),t.addEventListener("scroll",(function(e){a.scrollLeft!==t.scrollLeft&&(a.scrollLeft=t.scrollLeft)}))}}))}return(e,a)=>{const t=y("a-input"),l=y("a-form-item"),d=y("SearchOutlined"),p=y("a-button"),c=y("ReloadOutlined"),f=y("a-button-group"),v=y("a-row"),S=y("a-form"),I=y("a-pagination"),z=y("a-modal"),L=y("a-card");return b(),g(h,null,[O(S,{class:"smart-query-form"},{default:_((()=>[O(v,{class:"smart-query-form-row"},{default:_((()=>[O(l,{label:"关键字",class:"smart-query-form-item"},{default:_((()=>[O(t,{style:{width:"300px"},value:r.keywords,"onUpdate:value":a[0]||(a[0]=e=>r.keywords=e),placeholder:"变更内容"},null,8,["value"])])),_:1}),O(l,{class:"smart-query-form-item smart-margin-left10"},{default:_((()=>[O(f,null,{default:_((()=>[O(p,{type:"primary",onClick:n},{icon:_((()=>[O(d)])),default:_((()=>[E(" 查询 ")])),_:1}),O(p,{onClick:o},{icon:_((()=>[O(c)])),default:_((()=>[E(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),O(L,{size:"small",bordered:!1},{default:_((()=>[O(P,{tableData:i.value,onShowDetail:N},null,8,["tableData"]),O(I,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:q(u),defaultPageSize:r.pageSize,current:r.pageNum,"onUpdate:current":a[1]||(a[1]=e=>r.pageNum=e),pageSize:r.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>r.pageSize=e),total:s.value,onChange:m,onShowSizeChange:m,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"]),O(z,{open:j.value,"onUpdate:open":a[3]||(a[3]=e=>j.value=e),width:"90%",title:"数据比对",footer:null},{default:_((()=>[k("div",{innerHTML:q(w)},null,8,H)])),_:1},8,["open"])])),_:1})],64)}}},J={GOODS:{value:1,desc:"商品"},OA_NOTICE:{value:2,desc:"OA-通知公告"},OA_ENTERPRISE:{value:3,desc:"OA-企业信息"}},Q={class:"detail-header"},B=n({__name:"enterprise-detail",setup(o){const n=a();let d=z();C((()=>{n.query.enterpriseId&&(d.value=Number(n.query.enterpriseId),v())}));const u=z();function c(){u.value.showModal(d.value)}let f=z({});async function v(){try{let e=await s.detail(d.value);f.value=e.data}catch(e){p.captureError(e)}finally{m.hide()}}const w=T((()=>{let e="";return f.value?(f.value.provinceName&&(e+=f.value.provinceName),f.value.cityName&&(e+=f.value.cityName),f.value.districtName&&(e+=f.value.districtName),e):e})),I=T((()=>f.value?e.isEmpty(f.value.enterpriseLogo)?"":f.value.enterpriseLogo[0].fileUrl:""));return(e,a)=>{const s=y("a-button"),o=y("a-descriptions-item"),n=y("a-descriptions"),p=y("a-page-header"),m=y("a-tab-pane"),z=y("a-tabs"),L=y("a-card");return b(),g(h,null,[k("div",Q,[O(p,{title:q(f).enterpriseName,avatar:{src:I.value}},{extra:_((()=>[O(s,{onClick:c,type:"primary"},{default:_((()=>[E("编辑")])),_:1})])),default:_((()=>[k("div",null,[O(n,{size:"small",column:3},{default:_((()=>[O(o,{label:"统一社会信用代码"},{default:_((()=>[E(S(q(f).unifiedSocialCreditCode),1)])),_:1}),O(o,{label:"联系人"},{default:_((()=>[E(S(q(f).contact),1)])),_:1}),O(o,{label:"联系人电话"},{default:_((()=>[E(S(q(f).contactPhone),1)])),_:1}),O(o,{label:"邮箱"},{default:_((()=>[E(S(q(f).email),1)])),_:1}),O(o,{label:"所在城市"},{default:_((()=>[E(S(w.value),1)])),_:1}),O(o,{label:"详细地址"},{default:_((()=>[E(S(q(f).address),1)])),_:1}),O(o,{label:"创建时间"},{default:_((()=>[E(S(q(f).createTime),1)])),_:1}),O(o,{label:"创建人"},{default:_((()=>[E(S(q(f).createUserName),1)])),_:1}),O(o,{label:"营业执照"},{default:_((()=>[O(A,{"file-list":q(f).businessLicense},null,8,["file-list"])])),_:1})])),_:1})])])),_:1},8,["title","avatar"])]),e.$privilege("oa:enterprise:queryEmployee")||e.$privilege("oa:bank:query")||e.$privilege("oa:invoice:query")?(b(),j(L,{key:0,class:"smart-margin-top10",size:"small"},{default:_((()=>[O(z,null,{default:_((()=>[e.$privilege("oa:enterprise:queryEmployee")?(b(),j(m,{key:"employee",tab:"员工信息"},{default:_((()=>[O(r,{enterpriseId:q(d)},null,8,["enterpriseId"])])),_:1})):N("",!0),e.$privilege("oa:bank:query")?(b(),j(m,{key:"bank",tab:"银行信息"},{default:_((()=>[O(t,{enterpriseId:q(d)},null,8,["enterpriseId"])])),_:1})):N("",!0),e.$privilege("oa:invoice:query")?(b(),j(m,{key:"invoice",tab:"发票信息"},{default:_((()=>[O(l,{enterpriseId:q(d)},null,8,["enterpriseId"])])),_:1})):N("",!0),O(m,{key:"dataTracer",tab:"变更记录"},{default:_((()=>[O(F,{dataId:q(d),type:q(J).OA_ENTERPRISE.value},null,8,["dataId","type"])])),_:1})])),_:1}),O(i,{ref_key:"operateRef",ref:u,onRefresh:v},null,512)])),_:1})):N("",!0)],64)}}},[["__scopeId","data-v-2f70c056"]]);export{B as default};
