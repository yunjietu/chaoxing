import{c as e}from"./category-api-CAxoDcQy.js";import{s as a,g as l,p as t,b as o,u as d,G as s,C as u,D as r,S as i}from"./index-SeYMZHv7.js";import{r as n,w as p,e as c,b2 as g,ag as v,o as m,aR as y,m as f,b,c as h,bz as _,F as S,b0 as O,J as w,be as x,a as T,ai as j,u as G,n as C}from"./@vue-wTDZSr7R.js";import{_ as I}from"./lodash-DG05lPuJ.js";import N from"./index-DPBcXeae.js";import{b as U}from"./ant-design-vue-qdrtx42b.js";const k={__name:"index",props:{value:Number,placeholder:{type:String,default:"请选择"},categoryType:Number,width:{type:String,default:"100%"}},emits:["update:value","change"],setup(l,{emit:t}){const o=l,d=t,s=n([]);async function u(){if(o.categoryType)try{let a={categoryType:o.categoryType},l=await e.queryCategoryTree(a);s.value=l.data}catch(l){a.captureError(l)}else s.value=[]}const r=n(o.value);function i(e){d("update:value",e),d("change",e)}return p((()=>o.value),(e=>{r.value=e})),p((()=>o.categoryType),(()=>{u()})),c(u),(e,a)=>{const t=g("a-tree-select");return m(),v(t,{value:r.value,"onUpdate:value":a[0]||(a[0]=e=>r.value=e),style:y(`width:${l.width}`),"dropdown-style":{maxHeight:"400px",overflowX:"auto"},"tree-data":s.value,placeholder:l.placeholder,allowClear:!0,"tree-default-expand-all":"",onChange:i},null,8,["value","style","tree-data","placeholder"])}}},z=Object.freeze(Object.defineProperty({__proto__:null,default:k},Symbol.toStringTag,{value:"Module"})),A={addGoods:e=>t("/goods/add",e),deleteGoods:e=>o(`/goods/delete/${e}`),batchDelete:e=>t("/goods/batchDelete",e),queryGoodsList:e=>t("/goods/query",e),updateGoods:e=>t("/goods/update",e),importGoods:e=>t("/goods/importGoods",e),exportGoods:()=>l("/goods/exportGoods")},D={__name:"index",props:{dictCode:String,value:[Array,String,Number],mode:{type:String,default:"combobox"},width:{type:String,default:"200px"},placeholder:{type:String,default:"请选择"},size:{type:String,default:"default"},disabled:{type:Boolean,default:!1},disabledOption:{type:Array,default:()=>[]},hiddenOption:{type:Array,default:()=>[]}},emits:["update:value","change"],setup(e,{emit:a}){const l=e,t=f((()=>d().getDictData(l.dictCode).filter((e=>!l.hiddenOption.includes(e.dataValue)&&!e.disabledFlag)))),o=n(l.value);p((()=>l.value),(e=>{Array.isArray(e)?o.value=e.filter((e=>!l.disabledOption.includes(e)&&!l.hiddenOption.includes(e))):o.value=l.hiddenOption.includes(e)||l.disabledOption.includes(e)?void 0:e}),{immediate:!0});const s=a;function u(e){s("update:value",e),s("change",e)}return(a,d)=>{const s=g("a-select-option"),r=g("a-select");return m(),b("div",null,[h(r,{value:o.value,"onUpdate:value":d[0]||(d[0]=e=>o.value=e),style:y(`width: ${e.width}`),placeholder:l.placeholder,allowClear:!0,size:e.size,mode:e.mode,onChange:u,disabled:e.disabled},{default:_((()=>[(m(!0),b(S,null,O(t.value,(a=>(m(),v(s,{key:a.dataValue,value:a.dataValue,disabled:e.disabledOption.includes(a.valueCode)},{default:_((()=>[w(x(a.dataLabel),1)])),_:2},1032,["value","disabled"])))),128))])),_:1},8,["value","style","placeholder","size","mode","disabled"])])}}},q=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"})),E={style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},F={__name:"goods-form-modal",emits:["reloadList"],setup(e,{expose:l,emit:t}){const o=t,d=n(),p={categoryId:void 0,goodsName:void 0,goodsStatus:s.APPOINTMENT.value,place:[],price:void 0,shelvesFlag:!0,remark:"",goodsId:void 0};let c=T({...p});const y={categoryId:[{required:!0,message:"请选择商品分类"}],goodsName:[{required:!0,message:"商品名称不能为空"}],goodsStatus:[{required:!0,message:"商品状态不能为空"}],price:[{required:!0,message:"商品价格不能为空"}],place:[{required:!0,message:"产地不能为空"}]},f=n(!1);function b(){Object.assign(c,p),f.value=!1}function S(){d.value.validate().then((async()=>{i.show();try{c.goodsId?await A.updateGoods(c):await A.addGoods(c),U.success((c.goodsId?"修改":"添加")+"成功"),b(),o("reloadList")}catch(e){a.captureError(e)}finally{i.hide()}})).catch((e=>{U.error("参数验证错误，请仔细填写表单数据!")}))}return l({showDrawer:function(e){Object.assign(c,p),e&&!I.isEmpty(e)&&Object.assign(c,e),c.place&&c.place.length>0&&(c.place=c.place.split(",")),f.value=!0,C((()=>{d.value.clearValidate()}))}}),(e,a)=>{const l=g("a-form-item"),t=g("a-input"),o=g("a-radio"),s=g("a-radio-group"),i=g("a-input-number"),n=g("a-form"),p=g("a-button"),O=g("a-drawer");return m(),v(O,{title:G(c).goodsId?"编辑":"添加",width:500,open:f.value,"body-style":{paddingBottom:"80px"},onClose:b},{default:_((()=>[h(n,{ref_key:"formRef",ref:d,model:G(c),rules:y,"label-col":{span:5}},{default:_((()=>[h(l,{label:"商品分类",name:"categoryId"},{default:_((()=>[h(k,{value:G(c).categoryId,"onUpdate:value":a[0]||(a[0]=e=>G(c).categoryId=e),placeholder:"请选择商品分类",categoryType:G(u).GOODS.value},null,8,["value","categoryType"])])),_:1}),h(l,{label:"商品名称",name:"goodsName"},{default:_((()=>[h(t,{value:G(c).goodsName,"onUpdate:value":a[1]||(a[1]=e=>G(c).goodsName=e),placeholder:"请输入商品名称"},null,8,["value"])])),_:1}),h(l,{label:"商品状态",name:"goodsStatus"},{default:_((()=>[h(N,{"enum-name":"GOODS_STATUS_ENUM",value:G(c).goodsStatus,"onUpdate:value":a[2]||(a[2]=e=>G(c).goodsStatus=e)},null,8,["value"])])),_:1}),h(l,{label:"产地",name:"place"},{default:_((()=>[h(D,{width:"100%","dict-code":G(r).GOODS_PLACE,value:G(c).place,"onUpdate:value":a[3]||(a[3]=e=>G(c).place=e),mode:"tags"},null,8,["dict-code","value"])])),_:1}),h(l,{label:"上架状态",name:"shelvesFlag"},{default:_((()=>[h(s,{value:G(c).shelvesFlag,"onUpdate:value":a[4]||(a[4]=e=>G(c).shelvesFlag=e)},{default:_((()=>[h(o,{value:!0},{default:_((()=>[w("上架")])),_:1}),h(o,{value:!1},{default:_((()=>[w("下架")])),_:1})])),_:1},8,["value"])])),_:1}),h(l,{label:"商品价格",name:"price"},{default:_((()=>[h(i,{style:{width:"100%"},placeholder:"请输入商品价格",value:G(c).price,"onUpdate:value":a[5]||(a[5]=e=>G(c).price=e),min:0},null,8,["value"])])),_:1}),h(l,{label:"备注",name:"remark"},{default:_((()=>[h(t,{style:{width:"100%"},placeholder:"请输入备注",value:G(c).remark,"onUpdate:value":a[6]||(a[6]=e=>G(c).remark=e)},null,8,["value"])])),_:1})])),_:1},8,["model"]),j("div",E,[h(p,{style:{"margin-right":"8px"},onClick:b},{default:_((()=>[w("取消")])),_:1}),h(p,{type:"primary",onClick:S},{default:_((()=>[w("提交")])),_:1})])])),_:1},8,["title","open"])}}},P=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{k as _,D as a,F as b,q as c,P as d,A as g,z as i};
