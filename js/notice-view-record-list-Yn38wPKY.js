import{n as e}from"./notice-api-CJupa0Sd.js";import{c as t,P as a}from"./index-SeYMZHv7.js";import{_ as i}from"./index-D6sqxCCk.js";import{u as o}from"./ua-parser-js-D9VovvTw.js";import{r as s,a as r,b2 as l,b as n,o as p,c as m,ai as d,bz as u,J as c,ah as f,F as j,be as g,u as v}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./department-api-IZzKtGZG.js";const y={class:"smart-query-table-page"},h={__name:"notice-view-record-list",props:{noticeId:{type:[Number,String]}},setup(h,{expose:w}){const b=h;w({onSearch:q});const I=[{title:"姓名",dataIndex:"employeeName"},{title:"查看次数",dataIndex:"pageViewCount"},{title:"首次查看设备",dataIndex:"firstIp"},{title:"首次查看时间",dataIndex:"createTime"},{title:"最后一次查看设备",dataIndex:"lastIp"},{title:"最后一次查看时间",dataIndex:"updateTime",with:80}],x=s([]),S=s(0),z=s(!1),_={noticeId:b.noticeId,departmentId:null,keywords:"",pageNum:1,pageSize:t},k=r({..._});function C(e){if(!e)return"";let t=o(e);return t.browser.name+"/"+t.os.name+"/"+(t.device.vendor?t.device.vendor+t.device.model:"")}async function N(){try{z.value=!0;const t=await e.queryViewRecord(k);for(const e of t.data.list)e.firstDevice=C(e.firstUserAgent),e.lastDevice=C(e.lastUserAgent);x.value=t.data.list,S.value=t.data.total}catch(t){}finally{z.value=!1}}function q(){k.pageNum=1,N()}function U(){Object.assign(k,_),N()}return(e,t)=>{const o=l("a-form-item"),s=l("a-input"),r=l("SearchOutlined"),h=l("a-button"),w=l("ReloadOutlined"),b=l("a-button-group"),_=l("a-row"),C=l("a-form"),D=l("a-table"),O=l("a-pagination");return p(),n("div",null,[m(C,{class:"smart-query-form"},{default:u((()=>[m(_,{class:"smart-query-form-row"},{default:u((()=>[m(o,{label:"部门",class:"smart-query-form-item",style:{width:"280px","margin-right":"20px"}},{default:u((()=>[m(i,{value:k.departmentId,"onUpdate:value":t[0]||(t[0]=e=>k.departmentId=e),width:"100%"},null,8,["value"])])),_:1}),m(o,{label:"关键字",class:"smart-query-form-item",style:{width:"280px"}},{default:u((()=>[m(s,{value:k.keywords,"onUpdate:value":t[1]||(t[1]=e=>k.keywords=e),placeholder:"姓名/IP/设备"},null,8,["value"])])),_:1}),m(o,{class:"smart-query-form-item smart-margin-left10"},{default:u((()=>[m(b,null,{default:u((()=>[m(h,{type:"primary",onClick:q},{icon:u((()=>[m(r)])),default:u((()=>[c(" 查询 ")])),_:1}),m(h,{onClick:U},{icon:u((()=>[m(w)])),default:u((()=>[c(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(D,{rowKey:"employeeId",columns:I,dataSource:x.value,pagination:!1,loading:z.value,size:"small",bordered:""},{bodyCell:u((({column:e,record:t,text:a})=>["employeeName"===e.dataIndex?(p(),n(j,{key:0},[c(g(a)+"("+g(t.departmentName)+") ",1)],64)):f("",!0),"firstIp"===e.dataIndex?(p(),n(j,{key:1},[c(g(a)+" ("+g(t.firstDevice)+") ",1)],64)):f("",!0),"lastIp"===e.dataIndex?(p(),n(j,{key:2},[c(g(a)+" ("+g(t.lastDevice)+") ",1)],64)):f("",!0)])),_:1},8,["dataSource","loading"]),d("div",y,[m(O,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:v(a),defaultPageSize:k.pageSize,current:k.pageNum,"onUpdate:current":t[2]||(t[2]=e=>k.pageNum=e),pageSize:k.pageSize,"onUpdate:pageSize":t[3]||(t[3]=e=>k.pageSize=e),total:S.value,onChange:N,onShowSizeChange:N,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])}}};export{h as default};
