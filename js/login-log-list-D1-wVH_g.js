import{L as e,P as a,s as t}from"./index-SeYMZHv7.js";import{d as s}from"./default-time-ranges-C0dlfVG_.js";import{u as l}from"./ua-parser-js-D9VovvTw.js";import{c as o,l as r}from"./table-auto-height-Bjk5_fgC.js";import{_ as i}from"./index-C3kHkCVg.js";import{T as n}from"./table-id-const-CfofKxZg.js";import{r as u,a as d,e as m,l as p,b2 as c,z as g,b as f,o as v,y,c as j,ag as _,bz as b,u as h,J as I,ai as w,ah as x,F as S,be as z}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const N={key:1},O={key:2},k={class:"smart-query-table-page"},L={__name:"login-log-list",setup(L){const P=u([{title:"用户ID",dataIndex:"userId",width:70},{title:"用户名",dataIndex:"userName",ellipsis:!0},{title:"类型",dataIndex:"userType",width:50,ellipsis:!0},{title:"IP",dataIndex:"loginIp",ellipsis:!0},{title:"IP地区",dataIndex:"loginIpRegion",ellipsis:!0},{title:"设备信息",dataIndex:"userAgent",ellipsis:!0},{title:"结果",dataIndex:"loginResult",ellipsis:!0},{title:"备注",dataIndex:"remark",ellipsis:!0},{title:"时间",dataIndex:"createTime",width:150}]),U={userName:"",ip:"",startDate:void 0,endDate:void 0,pageNum:1,pageSize:10},q=d({...U}),C=u([]),E=s;function R(e,a){q.startDate=a[0],q.endDate=a[1]}const D=u(!1),T=u([]),A=u(0);function G(){Object.assign(q,U),C.value=[],F()}function V(){q.pageNum=1,F()}async function F(){try{D.value=!0;let e=await r.queryList(q);for(const t of e.data.list){if(!t.userAgent)continue;let e=l(t.userAgent);t.browser=e.browser.name,t.os=e.os.name,t.device=e.device.vendor?e.device.vendor+e.device.model:""}const a=e.data.list;A.value=e.data.total,T.value=a}catch(e){t.captureError(e)}finally{D.value=!1}}const B=u(100),J=u(),Q=u();function $(){o(B,[J,Q],10)}return window.addEventListener("resize",$),m((()=>{F(),$()})),p((()=>{window.removeEventListener("resize",$)})),(t,s)=>{const l=c("a-input"),o=c("a-form-item"),r=c("a-range-picker"),u=c("SearchOutlined"),d=c("a-button"),m=c("ReloadOutlined"),p=c("a-button-group"),L=c("a-row"),U=c("a-form"),$=c("a-tag"),K=c("a-table"),M=c("a-pagination"),Y=c("a-card"),H=g("privilege");return v(),f(S,null,[y((v(),_(U,{class:"smart-query-form",ref_key:"queryFormRef",ref:Q},{default:b((()=>[j(L,{class:"smart-query-form-row"},{default:b((()=>[j(o,{label:"用户名称",class:"smart-query-form-item"},{default:b((()=>[j(l,{style:{width:"300px"},value:q.userName,"onUpdate:value":s[0]||(s[0]=e=>q.userName=e),placeholder:"用户名称"},null,8,["value"])])),_:1}),j(o,{label:"用户IP",class:"smart-query-form-item"},{default:b((()=>[j(l,{style:{width:"120px"},value:q.ip,"onUpdate:value":s[1]||(s[1]=e=>q.ip=e),placeholder:"IP"},null,8,["value"])])),_:1}),j(o,{label:"时间",class:"smart-query-form-item"},{default:b((()=>[j(r,{onChange:R,value:C.value,"onUpdate:value":s[2]||(s[2]=e=>C.value=e),presets:h(E),style:{width:"240px"}},null,8,["value","presets"])])),_:1}),j(o,{class:"smart-query-form-item smart-margin-left10"},{default:b((()=>[j(p,null,{default:b((()=>[j(d,{type:"primary",onClick:V},{icon:b((()=>[j(u)])),default:b((()=>[I(" 查询 ")])),_:1}),j(d,{onClick:G},{icon:b((()=>[j(m)])),default:b((()=>[I(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[H,"support:loginLog:query"]]),j(Y,{size:"small",bordered:!1,hoverable:!0},{default:b((()=>[j(L,{justify:"end",ref_key:"tableOperatorRef",ref:J},{default:b((()=>[j(i,{class:"smart-margin-bottom5",modelValue:P.value,"onUpdate:modelValue":s[3]||(s[3]=e=>P.value=e),tableId:h(n).SUPPORT.LOGIN_LOG,refresh:F},null,8,["modelValue","tableId"])])),_:1},512),j(K,{size:"small",dataSource:T.value,columns:P.value,bordered:"",rowKey:"loginLogId",pagination:!1,loading:D.value,scroll:{y:B.value}},{bodyCell:b((({text:a,record:s,column:l})=>["loginResult"===l.dataIndex?(v(),f(S,{key:0},[a===h(e).LOGIN_SUCCESS.value?(v(),_($,{key:0,color:"success"},{default:b((()=>[I("登录成功")])),_:1})):x("",!0),a===h(e).LOGIN_FAIL.value?(v(),_($,{key:1,color:"error"},{default:b((()=>[I("登录失败")])),_:1})):x("",!0),a===h(e).LOGIN_OUT.value?(v(),_($,{key:2,color:"processing"},{default:b((()=>[I("退出登录")])),_:1})):x("",!0)],64)):x("",!0),"userAgent"===l.dataIndex?(v(),f("div",N,z(s.browser)+" / "+z(s.os)+" / "+z(s.device),1)):x("",!0),"userType"===l.dataIndex?(v(),f("span",O,z(t.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",a)),1)):x("",!0)])),_:1},8,["dataSource","columns","loading","scroll"]),w("div",k,[j(M,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:h(a),defaultPageSize:q.pageSize,current:q.pageNum,"onUpdate:current":s[4]||(s[4]=e=>q.pageNum=e),pageSize:q.pageSize,"onUpdate:pageSize":s[5]||(s[5]=e=>q.pageSize=e),total:A.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1})],64)}}};export{L as default};
