import{c as e}from"./code-generator-api-Bn5HnNZY.js";import{L as t,J as a,T as n,a as l}from"./code-generator-util-BIgdvUgd.js";import{_ as r,s}from"./index-SeYMZHv7.js";import{H as o,j as i,a as u}from"./highlight.js-ZAWCMeZZ.js";import{b as p}from"./ant-design-vue-qdrtx42b.js";import{r as c,m as d,b2 as m,ag as v,o as g,bz as f,c as j,ai as h,u as b,J as y,b as x,F as C,b0 as w,aP as L,be as _,n as T,aY as N,aW as F}from"./@vue-wTDZSr7R.js";import"./str-util-BDLBIRqu.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-Dk7pxPyP.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";let H="hljs-ln",M="hljs-ln-line",E="hljs-ln-code",S="hljs-ln-numbers",k="hljs-ln-n",z="data-line-number",A=/\r\n|\r|\n/g;function J(e,t){"object"==typeof e&&(e.innerHTML=function(e,t){let a=function(e,t){return t=t||{},{singleLine:K(t),startFrom:q(e,t)}}(e,t);return O(e),function(e,t){let a=U(e);""===a[a.length-1].trim()&&a.pop();if(a.length>1||t.singleLine){let e="";for(let n=0,l=a.length;n<l;n++)e+=B('<tr><td class="{0} {1}" {3}="{5}"><div class="{2}" {3}="{5}"></div></td><td class="{0} {4}" {3}="{5}">{6}</td></tr>',[M,S,k,z,E,n+t.startFrom,a[n].length>0?a[n]:" "]);return B('<table class="{0}">{1}</table>',[H,e])}return e}(e.innerHTML,a)}(e,t))}function K(e){return!!e.singleLine&&e.singleLine}function q(e,t){let a=1;isFinite(t.startFrom)&&(a=t.startFrom);let n=function(e,t){return e.hasAttribute(t)?e.getAttribute(t):null}(e,"data-ln-start-from");return null!==n&&(a=function(e,t){if(!e)return t;let a=Number(e);return isFinite(a)?a:t}(n,1)),a}function O(e){let t=e.childNodes;for(let a in t)if(t.hasOwnProperty(a)){let e=t[a];(e.textContent.trim().match(A)||[]).length>0&&(e.childNodes.length>0?O(e):P(e.parentNode))}}function P(e){let t=e.className;if(!/hljs-/.test(t))return;let a=U(e.innerHTML);for(var n=0,l="";n<a.length;n++){l+=B('<span class="{0}">{1}</span>\n',[t,a[n].length>0?a[n]:" "])}e.innerHTML=l.trim()}function U(e){return 0===e.length?[]:e.split(A)}function B(e,t){return e.replace(/\{(\d+)\}/g,(function(e,a){return void 0!==t[a]?t[a]:e}))}!function(){let e=document.createElement("style");e.type="text/css",e.innerHTML=B(".{0}{border-collapse:collapse}.{0} td{padding:0}.{1}:before{content:attr({2})}",[H,k,z]),document.getElementsByTagName("head")[0].appendChild(e)}();const D=(e=>(N("data-v-7eeb07fe"),e=e(),F(),e))((()=>h("strong",null,"下载代码",-1))),I=r({__name:"code-generator-preview-modal",setup(r,{expose:N}){const F=c(!1);function H(){F.value=!1}const M=c(""),E=c(""),S=c(t[0]),k=d((()=>S.value===t[0]?a:S.value===t[1]?n:l)),z=c(k.value[0]);function A(e){e.target.value===t[0]?z.value=a[0]:e.target.value===t[1]?z.value=n[0]:z.value=l[0],O(z.value)}function K(t){e.downloadCode(M.value)}const q=c("language-javascript");function O(a){let n=a,l=S.value===t[0]?"javascript":S.value===t[1]?"typescript":"java";o.registerLanguage(l,"java"==l?i:u),q.value="language-"+l,T((()=>{!async function(t,a){try{let n=await e.preview({templateFile:t,tableName:a});P.value=n.data,T((()=>{document.querySelectorAll("pre code").forEach((e=>{e.setAttribute("highlighted","true"),o.highlightElement(e),J(e),e.innerHTML="<div><div style='padding: 5px 0px 10px 20px;float:right'><span style='margin-right: 10px;padding: 5px;border: white solid 1px;color:white;border-radius: 2px'>"+e.className.match(/(?<=language-).*(?= hljs)/).toString()+"</span><button class='ant-btn ant-btn-sm' >复制代码</button></div>"+e.innerHTML+"</div>";let t=e.querySelector("button");null!=t&&(t.onclick=function(){!function(e){let t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("Copy"),document.body.removeChild(t)}(P.value),p.success("复制成功！")})}))}))}catch(n){s.captureError(n)}}(n,M.value)}))}const P=c("");return N({showModal:function(e){M.value=e.tableName,E.value=e.tableComment,F.value=!0,T((()=>{O(z.value)}))}}),(e,a)=>{const n=m("a-radio-button"),l=m("a-radio-group"),r=m("a-button"),s=m("a-row"),o=m("a-tab-pane"),i=m("a-tabs"),u=m("a-drawer");return g(),v(u,{title:"代码预览",open:F.value,width:1200,footerStyle:{textAlign:"right"},bodyStyle:{padding:"8px 24px"},onClose:H,maskClosable:!1,destroyOnClose:!0},{default:f((()=>[j(s,{justify:"space-between",class:"smart-margin-bottom10"},{default:f((()=>[j(l,{value:S.value,"onUpdate:value":a[0]||(a[0]=e=>S.value=e),"button-style":"solid",onChange:A},{default:f((()=>[j(n,{value:b(t)[0]},{default:f((()=>[y("JavaScript代码")])),_:1},8,["value"]),j(n,{value:b(t)[1]},{default:f((()=>[y("TypeScript代码")])),_:1},8,["value"]),j(n,{value:b(t)[2]},{default:f((()=>[y("Java代码")])),_:1},8,["value"])])),_:1},8,["value"]),j(r,{type:"link",onClick:K,danger:"",size:"small"},{default:f((()=>[D])),_:1})])),_:1}),j(i,{activeKey:z.value,"onUpdate:activeKey":a[1]||(a[1]=e=>z.value=e),size:"small",onChange:O},{default:f((()=>[(g(!0),x(C,null,w(k.value,(e=>(g(),v(o,{key:e,tab:e},null,8,["tab"])))),128))])),_:1},8,["activeKey"]),h("div",null,[h("pre",null,[h("code",{class:L(q.value)},_(P.value),3)])])])),_:1},8,["open"])}}},[["__scopeId","data-v-7eeb07fe"]]);export{I as default};
