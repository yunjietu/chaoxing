import{P as e,U as a,F as t,k as l,s as i}from"./index-SeYMZHv7.js";import o from"./index-DPBcXeae.js";import{_ as r}from"./index-C3kHkCVg.js";import{d as s}from"./default-time-ranges-C0dlfVG_.js";import{F as d}from"./index-BX3Fdk_n.js";import{r as n,a as u,e as p,b2 as m,z as c,b as f,o as y,y as v,c as h,ag as g,bz as j,u as _,J as w,ai as b,ah as x,be as z,F as S}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-qdrtx42b.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-BpN5YQ3K.js";import"./vue-LkNShnlx.js";import"./@ctrl-BZ4iwDfm.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-BUNCmyKw.js";import"./stylis-cmx5w8r8.js";import"./vue-types-Ci_fOQyt.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-Dk7pxPyP.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DG05lPuJ.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DZLdcVEL.js";import"./@intlify-D9VlDxbJ.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-DUpU9tZe.js";import"./sm-crypto-CNoQwlJF.js";import"./jsbn-aJNYh3Pg.js";import"./nprogress-Buvl-64T.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const T={class:"smart-table-operate-block"},k={class:"smart-table-setting-block"},E={key:0},I={key:1},U={key:2,class:"smart-table-operate"},N={class:"smart-query-table-page"},C={__name:"file-list",setup(C){const F=n([{title:"主键ID",dataIndex:"fileId",ellipsis:!0,width:70},{title:"文件夹",dataIndex:"folderType",ellipsis:!0,width:100},{title:"文件名称",dataIndex:"fileName",width:200},{title:"文件大小",dataIndex:"fileSize",ellipsis:!0,width:100},{title:"文件类型",dataIndex:"fileType",ellipsis:!0,width:80},{title:"上传人",dataIndex:"creatorName",ellipsis:!0,width:100},{title:"人类型",dataIndex:"creatorUserType",ellipsis:!0,width:100},{title:"上传时间",dataIndex:"createTime",ellipsis:!0,width:150},{title:"操作",dataIndex:"action",width:120,fixed:"right"}]),M={folderType:void 0,fileName:void 0,fileKey:void 0,fileType:void 0,creatorName:void 0,createTime:[],createTimeBegin:void 0,createTimeEnd:void 0,pageNum:1,pageSize:10},q=u({...M}),P=n(!1),O=n([]),K=n(0);function B(){let e=q.pageSize;Object.assign(q,M),q.pageSize=e,D()}async function D(){P.value=!0;try{let e=await l.queryPage(q);for(const a of e.data.list)a.fileSize=R(a.fileSize);O.value=e.data.list,K.value=e.data.total}catch(e){i.captureError(e)}finally{P.value=!1}}function L(e,a){q.createTimeBegin=a[0],q.createTimeEnd=a[1]}function R(e){if(!e)return"";var a=1024;return e<a?e+"B":e<Math.pow(a,2)?(e/a).toFixed(2)+"KB":e<Math.pow(a,3)?(e/Math.pow(a,2)).toFixed(2)+"MB":e<Math.pow(a,4)?(e/Math.pow(a,3)).toFixed(2)+"G":(e/Math.pow(a,4)).toFixed(2)+"T"}const V=n();p(D);const J=n(!1);function Y(){J.value=!0}function $(){J.value=!1,D()}return(n,u)=>{const p=m("a-form-item"),C=m("a-input"),M=m("a-range-picker"),R=m("SearchOutlined"),Q=m("a-button"),A=m("ReloadOutlined"),G=m("a-button-group"),Z=m("a-row"),H=m("a-form"),W=m("cloud-upload-outlined"),X=m("a-table"),ee=m("a-pagination"),ae=m("a-modal"),te=m("a-card"),le=c("privilege");return y(),f(S,null,[v((y(),g(H,{class:"smart-query-form"},{default:j((()=>[h(Z,{class:"smart-query-form-row"},{default:j((()=>[h(p,{label:"文件夹类型",class:"smart-query-form-item"},{default:j((()=>[h(o,{width:"150px",value:q.folderType,"onUpdate:value":u[0]||(u[0]=e=>q.folderType=e),enumName:"FILE_FOLDER_TYPE_ENUM",placeholder:"文件夹类型"},null,8,["value"])])),_:1}),h(p,{label:"文件名",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:q.fileName,"onUpdate:value":u[1]||(u[1]=e=>q.fileName=e),placeholder:"文件名"},null,8,["value"])])),_:1}),h(p,{label:"文件Key",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:q.fileKey,"onUpdate:value":u[2]||(u[2]=e=>q.fileKey=e),placeholder:"文件Key"},null,8,["value"])])),_:1}),h(p,{label:"文件类型",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:q.fileType,"onUpdate:value":u[3]||(u[3]=e=>q.fileType=e),placeholder:"文件类型"},null,8,["value"])])),_:1}),h(p,{label:"创建人",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:q.creatorName,"onUpdate:value":u[4]||(u[4]=e=>q.creatorName=e),placeholder:"创建人"},null,8,["value"])])),_:1}),h(p,{label:"创建时间",class:"smart-query-form-item"},{default:j((()=>[h(M,{value:q.createTime,"onUpdate:value":u[5]||(u[5]=e=>q.createTime=e),presets:_(s),style:{width:"220px"},onChange:L},null,8,["value","presets"])])),_:1}),h(p,{class:"smart-query-form-item"},{default:j((()=>[h(G,null,{default:j((()=>[h(Q,{type:"primary",onClick:D},{icon:j((()=>[h(R)])),default:j((()=>[w(" 查询 ")])),_:1}),h(Q,{onClick:B},{icon:j((()=>[h(A)])),default:j((()=>[w(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[le,"support:file:query"]]),h(te,{size:"small",bordered:!1,hoverable:!0},{default:j((()=>[h(Z,{class:"smart-table-btn-block"},{default:j((()=>[b("div",T,[h(Q,{type:"primary",onClick:Y},{icon:j((()=>[h(W)])),default:j((()=>[w(" 上传文件 ")])),_:1})]),b("div",k,[h(r,{modelValue:F.value,"onUpdate:modelValue":u[6]||(u[6]=e=>F.value=e),tableId:null,refresh:D},null,8,["modelValue"])])])),_:1}),h(X,{size:"small",scroll:{x:1300},dataSource:O.value,columns:F.value,rowKey:"fileId",bordered:"",loading:P.value,pagination:!1},{bodyCell:j((({text:e,record:a,column:t})=>["folderType"===t.dataIndex?(y(),f("span",E,z(n.$smartEnumPlugin.getDescByValue("FILE_FOLDER_TYPE_ENUM",e)),1)):x("",!0),"creatorUserType"===t.dataIndex?(y(),f("span",I,z(n.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",e)),1)):x("",!0),"action"===t.dataIndex?(y(),f("div",U,[h(Q,{onClick:e=>{return t=a,void V.value.showPreview(t);var t},type:"link"},{default:j((()=>[w("查看")])),_:2},1032,["onClick"]),h(Q,{onClick:e=>async function(e){try{await l.downLoadFile(e.fileKey)}catch(a){i.captureError(a)}}(a),type:"link"},{default:j((()=>[w("下载")])),_:2},1032,["onClick"])])):x("",!0)])),_:1},8,["dataSource","columns","loading"]),b("div",N,[h(ee,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:_(e),defaultPageSize:q.pageSize,current:q.pageNum,"onUpdate:current":u[7]||(u[7]=e=>q.pageNum=e),pageSize:q.pageSize,"onUpdate:pageSize":u[8]||(u[8]=e=>q.pageSize=e),total:K.value,onChange:D,onShowSizeChange:D,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),h(d,{ref_key:"filePreviewModalRef",ref:V},null,512),h(ae,{open:J.value,"onUpdate:open":u[9]||(u[9]=e=>J.value=e),title:"上传文件",onOnCancel:$,onOk:$},{default:j((()=>[h(a,{"list-type":"text",maxUploadSize:5,buttonText:"点击上传文件",defaultFileList:[],multiple:!0,folder:_(t).COMMON.value},null,8,["folder"])])),_:1},8,["open"])])),_:1})],64)}}};export{C as default};
