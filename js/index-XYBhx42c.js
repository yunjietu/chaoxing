import{c as e,e as a,s as t,P as l}from"./index-SeYMZHv7.js";import{_ as o}from"./index-D6sqxCCk.js";import{b as s}from"./ant-design-vue-qdrtx42b.js";import{r as n,a as i,m as r,b2 as d,ag as u,o as c,bz as m,c as p,ai as g,J as f,u as v,ah as y,b as h,be as w}from"./@vue-wTDZSr7R.js";const b={key:1},_={class:"smart-query-table-page"},x={__name:"index",emits:["selectData"],setup(x,{expose:S,emit:z}){const I=z;S({showModal:async function(e){D.value=e||[],R.value=e||[],k.value=!0,F()}});const k=n(!1);function C(){Object.assign(j,U),R.value=[],k.value=!1}const q=n(!1),N=n(),O=n();let U={departmentId:void 0,disabledFlag:void 0,employeeIdList:void 0,keyword:void 0,searchCount:void 0,pageNum:1,pageSize:e,sortItemList:void 0};const j=i({...U});function E(){Object.assign(j,U),P()}function F(){j.pageNum=1,P()}async function P(){q.value=!0;try{let e=await a.queryEmployee(j);$.value=e.data.list,O.value=e.data.total}catch(e){t.captureError(e)}finally{q.value=!1}}const D=n([]);let R=n([]);const J=r((()=>R.value.length!==D.value.length));function K(e){R.value=e}function L(){if(!J.value)return void s.warning("请选择角色人员");const e=R.value.filter((e=>!D.value.includes(e)));I("selectData",e),C()}function M(e){return{disabled:D.value.includes(e.employeeId)}}const $=n([]),B=[{title:"姓名",dataIndex:"actualName"},{title:"手机号",dataIndex:"phone"},{title:"性别",dataIndex:"gender"},{title:"登录账号",dataIndex:"loginName"},{title:"状态",dataIndex:"disabledFlag"}];return(e,a)=>{const t=d("a-input"),s=d("a-form-item"),n=d("a-select-option"),i=d("a-select"),r=d("SearchOutlined"),x=d("a-button"),S=d("ReloadOutlined"),z=d("a-row"),I=d("a-form"),U=d("a-tag"),D=d("a-table"),J=d("a-pagination"),G=d("a-modal");return c(),u(G,{open:k.value,"onUpdate:open":a[5]||(a[5]=e=>k.value=e),width:900,title:"选择人员",onCancel:C,onOk:L},{default:m((()=>[p(I,{class:"smart-query-form"},{default:m((()=>[p(z,{class:"smart-query-form-row"},{default:m((()=>[p(s,{label:"关键字",class:"smart-query-form-item"},{default:m((()=>[p(t,{style:{width:"150px"},value:j.keyword,"onUpdate:value":a[0]||(a[0]=e=>j.keyword=e),placeholder:"关键字"},null,8,["value"])])),_:1}),p(s,{label:"部门",class:"smart-query-form-item"},{default:m((()=>[p(o,{style:{width:"200px"},ref_key:"departmentTreeSelect",ref:N,value:j.departmentId,"onUpdate:value":a[1]||(a[1]=e=>j.departmentId=e)},null,8,["value"])])),_:1}),p(s,{label:"状态",class:"smart-query-form-item"},{default:m((()=>[p(i,{style:{width:"120px"},value:j.disabledFlag,"onUpdate:value":a[2]||(a[2]=e=>j.disabledFlag=e),placeholder:"请选择状态",allowClear:""},{default:m((()=>[(c(),u(n,{key:1},{default:m((()=>[f(" 禁用 ")])),_:1})),(c(),u(n,{key:0},{default:m((()=>[f(" 启用 ")])),_:1}))])),_:1},8,["value"])])),_:1}),p(s,{class:"smart-query-form-item smart-margin-left10"},{default:m((()=>[p(x,{type:"primary",onClick:F},{icon:m((()=>[p(r)])),default:m((()=>[f(" 查询 ")])),_:1}),p(x,{onClick:E,class:"smart-margin-left10"},{icon:m((()=>[p(S)])),default:m((()=>[f(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1}),p(D,{"row-selection":{selectedRowKeys:v(R),onChange:K,getCheckboxProps:M},loading:q.value,size:"small",columns:B,"data-source":$.value,pagination:!1,bordered:"",rowKey:"employeeId",scroll:{y:300}},{bodyCell:m((({text:a,column:t})=>["disabledFlag"===t.dataIndex?(c(),u(U,{key:0,color:a?"error":"processing"},{default:m((()=>[f(w(a?"禁用":"启用"),1)])),_:2},1032,["color"])):y("",!0),"gender"===t.dataIndex?(c(),h("span",b,w(e.$smartEnumPlugin.getDescByValue("GENDER_ENUM",a)),1)):y("",!0)])),_:1},8,["row-selection","loading","data-source"]),g("div",_,[p(J,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:v(l),defaultPageSize:j.pageSize,current:j.pageNum,"onUpdate:current":a[3]||(a[3]=e=>j.pageNum=e),pageSize:j.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>j.pageSize=e),total:O.value,onChange:P,onShowSizeChange:P,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1},8,["open"])}}};export{x as _};
